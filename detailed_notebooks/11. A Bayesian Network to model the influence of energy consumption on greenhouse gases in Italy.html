


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="10.%20Learning%20Bayesian%20Networks%20from%20Data.html">
      
      
        <link rel="next" href="../api.html">
      
      
      <link rel="icon" href="../_static/logo_favi.ico">
    
    
      
        <title>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy - pgmpy</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.553f2186060d16162.min.css?v=c794c0f9" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0be4c15b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  <!-- SEO meta tags -->
  <meta name="description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="keywords" content="pgmpy, Bayesian Networks, causal inference, probabilistic graphical models, structure learning, parameter estimation, Python">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="pgmpy">
  <meta property="og:title" content="A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy">
  <meta property="og:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta property="og:url" content="https://pgmpy.org/detailed_notebooks/11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html">
  <meta property="og:image" content="https://pgmpy.org/_static/logo.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy">
  <meta name="twitter:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="twitter:image" content="https://pgmpy.org/_static/logo.png">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HCFR07M31W');
  </script>
  <!-- EthicalAds -->
  <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
  <!-- Header social links styling -->
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500;600&display=swap");
    :root {
      --md-text-font: "Source Sans 3", system-ui, sans-serif;
      --md-code-font: "Source Code Pro", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .md-header__social {
      display: flex;
      align-items: center;
      gap: 0.1rem;
      margin-left: 0.4rem;
    }
    .md-header__social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem;
      color: var(--md-default-fg-color--light);
      opacity: 0.7;
      transition: opacity 0.25s;
    }
    .md-header__social a:hover {
      opacity: 1;
    }
    .md-header__social svg {
      width: 1.2rem;
      height: 1.2rem;
      fill: currentColor;
    }
    [data-md-color-scheme="slate"] .md-header__social a {
      color: var(--md-default-fg-color--light);
    }
    /* Card visibility in light/dark modes */
    .sd-card {
      background-color: var(--pgmpy-card-bg, var(--md-default-bg-color));
      border: 1px solid var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }
    .sd-card .sd-card-header,
    .sd-card .sd-card-footer {
      border-color: var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
    }
    [data-md-color-scheme="slate"] .sd-card {
      --pgmpy-card-bg: rgba(255, 255, 255, 0.045);
      --pgmpy-card-border: rgba(255, 255, 255, 0.2);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
    }
    /* Hover shadow effect on feature cards */
    .sd-card-hover {
      transition: box-shadow 0.25s ease, transform 0.25s ease;
    }
    .sd-card-hover:hover {
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }
    [data-md-color-scheme="slate"] .sd-card-hover:hover {
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.55);
    }
    /* Center content when right sidebar (toc) is hidden */
    .md-sidebar--secondary[hidden] ~ .md-content {
      margin-left: auto;
      margin-right: auto;
    }
  </style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#by-Lorenzo-Mario-Amorosa" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="pgmpy" class="md-header__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pgmpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../started/base.html" class="md-tabs__link">
        
  
    
  
  <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../documentation.html" class="md-tabs__link">
        
  
    
  
  <span title="/documentation.rst (reference label)"><span>Documentation</span></span>

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../examples.html" class="md-tabs__link">
        
  
    
  
  <span title="/examples.rst (reference label)"><span>Examples</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api.html" class="md-tabs__link">
        
  
    
  
  <span title="/api.rst (reference label)"><span>API Reference</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../citation.html" class="md-tabs__link">
        
  
    
  
  <span title="/citation.rst (reference label)"><span>Citation</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development.html" class="md-tabs__link">
        
  
    
  
  <span title="/development.rst (reference label)"><span>Getting Involved</span></span>

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="pgmpy" class="md-nav__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    pgmpy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../started/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/documentation.rst (reference label)"><span>Documentation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html#tutorial-notebooks" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_discrete_bn.ipynb (reference label)"><span>Creating Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Linear_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_linear_bn.ipynb (reference label)"><span>Creating Linear Gaussian Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Defining_CPDs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/defining_cpds.ipynb (reference label)"><span>How to define Tabular<wbr>CPD and Linear<wbr>Gaussian<wbr>CPD</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Basic_Operations_on_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/basic_operations_on_bn.ipynb (reference label)"><span>Basic Operations on Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning.ipynb (reference label)"><span>Structure Learning in Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_Chow_Liu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_chow_liu.ipynb (reference label)"><span>Learning Tree Structure from Data using the Chow-<wbr>Liu Algorithm</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_TAN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_tan.ipynb (reference label)"><span>Learning Tree-<wbr>augmented Naive Bayes <wbr>(TAN) Structure from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Expert_Knowledge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/expert_knowledge.ipynb (reference label)"><span>Expert Knowledge Integration with Causal Discovery</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_discrete_bn.ipynb (reference label)"><span>Parameter Learning in Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb (reference label)"><span>Marginal Learning in Discrete Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html#Modeling-the-home-&-visitor-scores" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb#modeling-the-home-&amp;-visitor-scores (reference label)"><span>Modeling the home &amp; visitor scores</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Inference_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/inference_discrete_bn.ipynb (reference label)"><span>Inference in Discrete Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Monty_Hall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/monty_hall.ipynb (reference label)"><span>Monty Hall Problem</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_inference.ipynb (reference label)"><span>Causal Inference Examples</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb (reference label)"><span>Causal Games</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-1" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-1 (reference label)"><span>Example 1</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-2" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-2 (reference label)"><span>Example 2</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-3" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-3 (reference label)"><span>Example 3</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-4" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-4 (reference label)"><span>Example 4</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-5" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-5 (reference label)"><span>Example 5</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-6" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-6 (reference label)"><span>Example 6</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-7" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-7 (reference label)"><span>Example 7</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Simulating_Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/simulating_data.ipynb (reference label)"><span>Simulating Data From Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Extending_pgmpy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/extending_pgmpy.ipynb (reference label)"><span>Extending pgmpy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Functional_Bayesian_Network_Tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/functional_bayesian_network_tutorial.ipynb (reference label)"><span>Functional Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Junction_Tree_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/junction_tree_inference.ipynb (reference label)"><span>Junction Tree Exact Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_27" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorial.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_27" id="__nav_3_1_27_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_27_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_27">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="1.%20Introduction%20to%20Probabilistic%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/1. introduction to probabilistic graphical models.ipynb (reference label)"><span>Introduction to Probabilitic Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="2.%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/2. bayesian networks.ipynb (reference label)"><span>Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="3.%20Causal%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/3. causal bayesian networks.ipynb (reference label)"><span>Causal Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="4.%20Markov%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/4. markov models.ipynb (reference label)"><span>Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="5.%20Exact%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/5. exact inference in graphical models.ipynb (reference label)"><span>Exact Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="6.%20Approximate%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/6. approximate inference in graphical models.ipynb (reference label)"><span>Approximate Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="7.%20Parameterizing%20with%20Continuous%20Variables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/7. parameterizing with continuous variables.ipynb (reference label)"><span>Parameterizing with Continuous Variables</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="8.%20Sampling%20Algorithms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="10.%20Learning%20Bayesian%20Networks%20from%20Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#by-Lorenzo-Mario-Amorosa" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#by-lorenzo-mario-amorosa (reference label)"><span>by Lorenzo Mario Amorosa</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="by Lorenzo Mario Amorosa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Fundamentals-of-Artificial-Intelligence-and-Knowledge-Representation-(Mod.-3)---Alma-Mater-Studiorum-Università-di-Bologna" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#fundamentals-of-artificial-intelligence-and-knowledge-representation-(mod.-3)---alma-mater-studiorum-università-di-bologna (reference label)"><span>Fundamentals of Artificial Intelligence and Knowledge Representation <wbr>(Mod.<wbr> 3) -<wbr> Alma Mater Studiorum Università di Bologna</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Abstract" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#abstract (reference label)"><span>Abstract</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Network-definition" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#network-definition (reference label)"><span>Network definition</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Datasets" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#datasets (reference label)"><span>Datasets</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Raw-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#raw-data (reference label)"><span>Raw data</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Data-cleaning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#data-cleaning (reference label)"><span>Data cleaning</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Data-discretization" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#data-discretization (reference label)"><span>Data discretization</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Learning-of-network-parameters" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#learning-of-network-parameters (reference label)"><span>Learning of network parameters</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Network-analysis" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#network-analysis (reference label)"><span>Network analysis</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Inferences" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#inferences (reference label)"><span>Inferences</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../citation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/citation.rst (reference label)"><span>Citation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../development.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/development.rst (reference label)"><span>Getting Involved</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#by-Lorenzo-Mario-Amorosa" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#by-lorenzo-mario-amorosa (reference label)"><span>by Lorenzo Mario Amorosa</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="by Lorenzo Mario Amorosa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Fundamentals-of-Artificial-Intelligence-and-Knowledge-Representation-(Mod.-3)---Alma-Mater-Studiorum-Università-di-Bologna" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#fundamentals-of-artificial-intelligence-and-knowledge-representation-(mod.-3)---alma-mater-studiorum-università-di-bologna (reference label)"><span>Fundamentals of Artificial Intelligence and Knowledge Representation <wbr>(Mod.<wbr> 3) -<wbr> Alma Mater Studiorum Università di Bologna</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Abstract" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#abstract (reference label)"><span>Abstract</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Network-definition" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#network-definition (reference label)"><span>Network definition</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Datasets" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#datasets (reference label)"><span>Datasets</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Raw-data" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#raw-data (reference label)"><span>Raw data</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Data-cleaning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#data-cleaning (reference label)"><span>Data cleaning</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Data-discretization" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#data-discretization (reference label)"><span>Data discretization</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Learning-of-network-parameters" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#learning-of-network-parameters (reference label)"><span>Learning of network parameters</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Network-analysis" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#network-analysis (reference label)"><span>Network analysis</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Inferences" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb#inferences (reference label)"><span>Inferences</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
  
                  


<h1 id="A-Bayesian-Network-to-model-the-influence-of-energy-consumption-on-greenhouse-gases-in-Italy">A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy<a class="headerlink" href="#A-Bayesian-Network-to-model-the-influence-of-energy-consumption-on-greenhouse-gases-in-Italy" title="Link to this heading">¶</a></h1>
<h2 id="by-Lorenzo-Mario-Amorosa">by <a class="reference external" href="https://github.com/Lostefra">Lorenzo Mario Amorosa</a><a class="headerlink" href="#by-Lorenzo-Mario-Amorosa" title="Link to this heading">¶</a></h2>
<h3 id="Fundamentals-of-Artificial-Intelligence-and-Knowledge-Representation-(Mod.-3)---Alma-Mater-Studiorum-Università-di-Bologna"><em>Fundamentals of Artificial Intelligence and Knowledge Representation (Mod. 3) - Alma Mater Studiorum Università di Bologna</em><a class="headerlink" href="#Fundamentals-of-Artificial-Intelligence-and-Knowledge-Representation-(Mod.-3)---Alma-Mater-Studiorum-Università-di-Bologna" title="Link to this heading">¶</a></h3>
<h2 id="Abstract">Abstract<a class="headerlink" href="#Abstract" title="Link to this heading">¶</a></h2>
<p><a href="#id1"><span class="problematic" id="id2">|9ac6ab5dc66c463fa7672d0c03d341ee|</span></a> Nowadays it is well established that <strong>global warming</strong> is hugely caused by greenhouse gases, which are indeed responsible for trapping heat in the atmosphere. The 3 most common gases are carbon dioxide (<strong>CO</strong>2), methane (<strong>CH</strong>4) and nitrous oxide (<strong>N</strong>2<strong>O</strong>) [1].</p>
<p>There are several sources of greenhouse gases, such as transportation, industry, commercial and residental. In this document I will tackle the problem in a general way, considering the impact of energy consumption on greenhouse gases emissions. Energy is indeed strictly related to almost all source factors. In particular, I will face the modelling of <strong>causal relations</strong> between <strong>energy consumption and greenhouse gases in Italy</strong> using a <strong>Bayesian network</strong>. The aim is to learn a model that
can provide <strong>probabilistic results given</strong> some input <strong>evidence</strong>. The causal relations and their relative probabilities will be estimated by analyzing <strong>annual growth factors</strong> of several indicators from open source datasets of the World Bank Group (WBG) [3]. The choice of analyzing the annual growth aims to capture how the variation of an indicator can affect the others.</p>
<p>This work starts from a paper by Cinar and Kayakutlu (2010) [2] in which the authors produced estimates about energy investments in Turkey given historical data. Their work helped me to come up with interesting measures to be investigated and to be represented in the Bayesian network. I could extend their work adding: a more comprehensive analysis of network properties (<strong>conditional independencies, active trails, Markov blankets</strong>), concise and effective high level functions (such
as <code class="docutils literal notranslate"><span class="pre">query_report</span></code>, <code class="docutils literal notranslate"><span class="pre">check_assertion</span></code> and <code class="docutils literal notranslate"><span class="pre">active_trails_of</span></code>) to express the most significant properties in a readable format and the whole code <strong>to learn the Bayesian network</strong> from the available datasets.</p>
<h2 id="Network-definition">Network definition<a class="headerlink" href="#Network-definition" title="Link to this heading">¶</a></h2>
<p>Generally we can expect that the increase of fossil fuel consumption determines the growth of greenhouse gases diffusion, whereas a wider use of renewable energies leads to a reduction of greenhouse gases emissions. In [2] it is suggested that growth rate factors about population, urbanization and gross domestic product (GDP) can all influence the overall energy use in a nation. Given these assumptions, the Bayesian network is defined as follows: <a href="#id3"><span class="problematic" id="id4">|11fc386053a04c6e868dafb3954f07b3|</span></a>
The terms in the nodes have the following labels in [3]:</p>
<p>Pop = Population growth (annual %)</p>
<p>Urb = Urban population growth (annual %)</p>
<p>GDP = GDP per capita growth (annual %)</p>
<p>EC = Energy use (kg of oil equivalent per capita) - [annual growth %]</p>
<p>FFEC = Fossil fuel energy consumption (% of total) - [annual growth %]</p>
<p>REC = Renewable energy consumption (% of total final energy consumption) - [annual growth %]</p>
<p>EI = Energy imports, net (% of energy use) - [annual growth %]</p>
<p>CO2 = CO2 emissions (metric tons per capita) - [annual growth %]</p>
<p>CH4 = Methane emissions in energy sector (thousand metric tons of CO2 equivalent) - [annual growth %]</p>
<p>N2O = Nitrous oxide emissions in energy sector (thousand metric tons of CO2 equivalent) - [annual growth %]</p>
<p>The Bayesian network proposed differs from the one of [2] because here greenhouse gases are kept distinct (CO2, CH4, N2O) and energy investments are not represented.</p>
<p>In the following cell the Bayesian network is created using the pgmpy library.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;Pop&#39;</span><span class="p">,</span> <span class="s1">&#39;EC&#39;</span><span class="p">),</span>   <span class="p">(</span><span class="s1">&#39;Urb&#39;</span><span class="p">,</span> <span class="s1">&#39;EC&#39;</span><span class="p">),</span>   <span class="p">(</span><span class="s1">&#39;GDP&#39;</span><span class="p">,</span> <span class="s1">&#39;EC&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;FFEC&#39;</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">),</span>   <span class="p">(</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;EI&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;REC&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;REC&#39;</span><span class="p">,</span> <span class="s1">&#39;CH4&#39;</span><span class="p">),</span>  <span class="p">(</span><span class="s1">&#39;REC&#39;</span><span class="p">,</span> <span class="s1">&#39;N2O&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;CH4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;N2O&#39;</span><span class="p">)])</span>
</code></pre></div>
</div>
</div>
<h2 id="Datasets">Datasets<a class="headerlink" href="#Datasets" title="Link to this heading">¶</a></h2>
<p>The <strong>data</strong> to compute the conditional probability tables (CPT) of the network are retrived from [3]. Some data are given there in absolute values and not in terms of <strong>annual growth</strong>, hence it is necessary to transform them properly (the labels of transformed data are marked with the trailing string “<em>- [annual growth %]</em>”).</p>
<p>A good methodology to organize <strong>historical data to infer CPT</strong>, as shown also in [2], is to <strong>group</strong> them <strong>by year</strong>, such that historical values of the same year are treated as a single tuple and thus they constitute a whole entry of the dataset. <strong>Data discretization</strong> is also needed, <a class="reference external" href="https://github.com/pgmpy/pgmpy/issues/1084">since pgmpy does not support learning from continuous variables</a>, and so all values are mapped into 3 fixed tiers. In order to minimize data
sparsity, the boundaries of the mapping intervals are chosen such that each tier of the same node contains an equal number of samples.</p>
<p>The pgmpy learning algorithms expect as input a dataframe in which each entry represents an <em>observed event</em> — a year in this case. As a consequence some <strong>data preprocessing</strong> is needed to make the raw data compatible with the required signature. It is worth noting that pgmpy handles learning task with <strong>sparse datasets</strong> (i.e. <a class="reference external" href="https://pgmpy.org/estimators.html">it handles NaN values</a>). To compute indeed the CPT for a given node in the network there are used only those entries in which both
the node itself and its parents are defined (i.e. an entry is used to compute a given CPT only if all needed values of that year are defined). This fact implies that the deeper the network is, the less sparse the dataset should be to compute significant CPT.</p>
<p>As a side note, mind the fact that industrialization growth, which is expressed by indicators such as <a class="reference external" href="https://data.worldbank.org/indicator/NV.IND.TOTL.KD.ZG?locations=IT&amp;view=chart">industry value added</a>, is not represented in the newtork. Data regarding industrialization are available only for a short year range in [3] and the industrialization node would be on top of the network hierarchy, being a parent of the node ‘EC’. As a consequence, if industrialization would be
represented, then the overall learning process could rely only on a small subset of all the available data and the network parameters would be estimated less significantly.</p>
<p>In the following cells data are imported and preprocessed.</p>
<h3 id="Raw-data">Raw data<a class="headerlink" href="#Raw-data" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csv</span><span class="p">,</span> <span class="n">DataFrame</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">annual_growth</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">years</span><span class="p">):</span>
    <span class="n">min_year</span> <span class="o">=</span> <span class="n">years</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span>
    <span class="n">max_year</span> <span class="o">=</span> <span class="n">years</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Indicator Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Indicator Name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; - [annual growth %]&quot;</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_year</span><span class="p">,</span> <span class="n">min_year</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]):</span>
            <span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]))</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">row</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">min_year</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">row</span>

<span class="n">years</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span> <span class="p">:</span> <span class="mi">1960</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span> <span class="p">:</span> <span class="mi">2019</span><span class="p">}</span>
<span class="n">df_raw</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../csv/italy-raw-data.csv&quot;</span><span class="p">)</span>
<span class="n">df_raw_growth</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">row</span> <span class="k">if</span> <span class="s2">&quot;growth&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Indicator Name&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="n">annual_growth</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">years</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df_raw_growth</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; indicators in the dataframe.&quot;</span><span class="p">)</span>
<span class="n">df_raw_growth</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There are 10 indicators in the dataframe.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>Indicator Name</th>
      <th>Indicator Code</th>
      <th>1960</th>
      <th>1961</th>
      <th>1962</th>
      <th>1963</th>
      <th>1964</th>
      <th>1965</th>
      <th>...</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>ITA</td>
      <td>Population growth (annual %)</td>
      <td>SP.POP.GROW</td>
      <td>1.993928</td>
      <td>0.668383</td>
      <td>0.676623</td>
      <td>0.729553</td>
      <td>0.822624</td>
      <td>0.842109</td>
      <td>...</td>
      <td>0.307591</td>
      <td>0.171978</td>
      <td>0.269541</td>
      <td>1.159251</td>
      <td>0.917504</td>
      <td>-0.096376</td>
      <td>-0.169884</td>
      <td>-0.149861</td>
      <td>-0.190064</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Italy</td>
      <td>ITA</td>
      <td>Urban population growth (annual %)</td>
      <td>SP.URB.GROW</td>
      <td>2.836401</td>
      <td>1.498807</td>
      <td>1.506833</td>
      <td>1.551287</td>
      <td>1.636027</td>
      <td>1.642485</td>
      <td>...</td>
      <td>0.480439</td>
      <td>0.343066</td>
      <td>0.619579</td>
      <td>1.587835</td>
      <td>1.341371</td>
      <td>0.325701</td>
      <td>0.246127</td>
      <td>0.262999</td>
      <td>0.228198</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Italy</td>
      <td>ITA</td>
      <td>GDP per capita growth (annual %)</td>
      <td>NY.GDP.PCAP.KD.ZG</td>
      <td>NaN</td>
      <td>7.486419</td>
      <td>5.487478</td>
      <td>4.842052</td>
      <td>1.955533</td>
      <td>2.402046</td>
      <td>...</td>
      <td>1.400915</td>
      <td>0.534287</td>
      <td>-3.242060</td>
      <td>-2.972404</td>
      <td>-0.917814</td>
      <td>0.875477</td>
      <td>1.451875</td>
      <td>1.868715</td>
      <td>0.966058</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Italy</td>
      <td>ITA</td>
      <td>Energy use (kg of oil equivalent per capita) -...</td>
      <td>EG.USE.PCAP.KG.OE</td>
      <td>NaN</td>
      <td>12.062200</td>
      <td>13.064053</td>
      <td>11.188621</td>
      <td>9.110076</td>
      <td>7.753922</td>
      <td>...</td>
      <td>2.113919</td>
      <td>-3.486796</td>
      <td>-4.211107</td>
      <td>-4.791839</td>
      <td>-6.396212</td>
      <td>2.786129</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Italy</td>
      <td>ITA</td>
      <td>Fossil fuel energy consumption (% of total) - ...</td>
      <td>EG.USE.COMM.FO.ZS</td>
      <td>NaN</td>
      <td>2.344018</td>
      <td>1.933224</td>
      <td>-0.167728</td>
      <td>1.075163</td>
      <td>-0.074481</td>
      <td>...</td>
      <td>-0.262284</td>
      <td>-0.193760</td>
      <td>-2.679745</td>
      <td>-2.721392</td>
      <td>-1.723158</td>
      <td>1.733165</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 64 columns</p>
</div></div>
</div>
<h3 id="Data-cleaning">Data cleaning<a class="headerlink" href="#Data-cleaning" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Pop&#39;</span><span class="p">,</span> <span class="s1">&#39;Urb&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">,</span> <span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">,</span> <span class="s1">&#39;EI&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CH4&#39;</span><span class="p">,</span> <span class="s1">&#39;N2O&#39;</span><span class="p">]</span>
<span class="n">df_growth</span> <span class="o">=</span> <span class="n">df_raw_growth</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<span class="n">df_growth</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">nodes</span>
<span class="n">df_growth</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pop</th>
      <th>Urb</th>
      <th>GDP</th>
      <th>EC</th>
      <th>FFEC</th>
      <th>REC</th>
      <th>EI</th>
      <th>CO2</th>
      <th>CH4</th>
      <th>N2O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>1.99393</td>
      <td>2.8364</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>0.668383</td>
      <td>1.49881</td>
      <td>7.48642</td>
      <td>12.0622</td>
      <td>2.34402</td>
      <td>NaN</td>
      <td>5.07261</td>
      <td>13.8924</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>0.676623</td>
      <td>1.50683</td>
      <td>5.48748</td>
      <td>13.0641</td>
      <td>1.93322</td>
      <td>NaN</td>
      <td>5.75395</td>
      <td>17.5887</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>0.729553</td>
      <td>1.55129</td>
      <td>4.84205</td>
      <td>11.1886</td>
      <td>-0.167728</td>
      <td>NaN</td>
      <td>2.51943</td>
      <td>12.5116</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>0.822624</td>
      <td>1.63603</td>
      <td>1.95553</td>
      <td>9.11008</td>
      <td>1.07516</td>
      <td>NaN</td>
      <td>0.631028</td>
      <td>6.78298</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1965</th>
      <td>0.842109</td>
      <td>1.64248</td>
      <td>2.40205</td>
      <td>7.75392</td>
      <td>-0.0744814</td>
      <td>NaN</td>
      <td>2.33506</td>
      <td>7.84845</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>0.777304</td>
      <td>1.56811</td>
      <td>5.16416</td>
      <td>8.70603</td>
      <td>0.552096</td>
      <td>NaN</td>
      <td>1.51847</td>
      <td>12.9005</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>0.723778</td>
      <td>1.50361</td>
      <td>6.40568</td>
      <td>8.41638</td>
      <td>1.19174</td>
      <td>NaN</td>
      <td>1.938</td>
      <td>9.41875</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1968</th>
      <td>0.631737</td>
      <td>1.40395</td>
      <td>5.87359</td>
      <td>9.46868</td>
      <td>0.880322</td>
      <td>NaN</td>
      <td>1.59627</td>
      <td>6.42744</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1969</th>
      <td>0.566059</td>
      <td>1.32609</td>
      <td>5.49918</td>
      <td>7.89391</td>
      <td>0.940778</td>
      <td>NaN</td>
      <td>0.725698</td>
      <td>8.22188</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h3 id="Data-discretization">Data discretization<a class="headerlink" href="#Data-discretization" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">TIERS_NUM</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">boundary_str</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">tier</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tier</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">start</span><span class="si">:</span><span class="s1">+0,.2f</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">end</span><span class="si">:</span><span class="s1">+0,.2f</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">relabel</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">boundary_str</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">tier</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">boundary_str</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">tier</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">boundary_str</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">tier</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_boundaries</span><span class="p">(</span><span class="n">tiers</span><span class="p">):</span>
    <span class="n">prev_tier</span> <span class="o">=</span> <span class="n">tiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[(</span><span class="n">prev_tier</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prev_tier</span><span class="p">[</span><span class="n">prev_tier</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">tier</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tiers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prev_tier</span><span class="p">[</span><span class="n">prev_tier</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tier</span><span class="p">[</span><span class="n">tier</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
            <span class="n">prev_tier</span> <span class="o">=</span> <span class="n">tier</span>
    <span class="k">return</span> <span class="n">boundaries</span>

<span class="n">new_columns</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_growth</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">series</span><span class="p">)</span> <span class="o">=</span> <span class="n">content</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">TIERS_NUM</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error: there are not enough data for label </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="n">get_boundaries</span><span class="p">(</span><span class="n">tiers</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">TIERS_NUM</span><span class="p">))</span>
    <span class="n">new_columns</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">relabel</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">new_columns</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">nodes</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">],</span> <span class="n">years</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pop</th>
      <th>Urb</th>
      <th>GDP</th>
      <th>EC</th>
      <th>FFEC</th>
      <th>REC</th>
      <th>EI</th>
      <th>CO2</th>
      <th>CH4</th>
      <th>N2O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1961</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1962</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>B: -0.40 to +0.16</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1964</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>B: +1.24 to +2.89</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>B: -0.38 to +0.78</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1965</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>B: +1.24 to +2.89</td>
      <td>C: +2.79 to +13.06</td>
      <td>B: -0.40 to +0.16</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1966</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1967</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1968</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>C: +0.78 to +5.75</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1969</th>
      <td>C: +0.50 to +1.99</td>
      <td>C: +0.82 to +2.84</td>
      <td>C: +2.89 to +7.49</td>
      <td>C: +2.79 to +13.06</td>
      <td>C: +0.16 to +2.34</td>
      <td>NaN</td>
      <td>B: -0.38 to +0.78</td>
      <td>C: +3.81 to +17.59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<h2 id="Learning-of-network-parameters">Learning of network parameters<a class="headerlink" href="#Learning-of-network-parameters" title="Link to this heading">¶</a></h2>
<p>In pgmpy it is possible to learn the CPT of a given Bayesian network using either a <strong>Bayesian Estimator</strong> or a <strong>Maximum Likelihood Estimator</strong> (MLE). The former exploits a known prior distribution of data, the latter does not make any particular assumption.</p>
<p><strong>MLE can overfit</strong> the data in case of <strong>small datasets</strong>, because there can be not enough observations and thus the observed frequencies can be not representative. Another problem with MLE is the fact that <strong>state counts</strong> are done <strong>conditionally</strong> for each <strong>parents configuration</strong> and this causes immense fragmentation since the state counts drop even more. The <strong>Bayesian estimator</strong> instead does not only rely on input data to learn the network parameters, but it also takes advantage of a
<strong>prior knowledge</strong>, expressed through a prior distribution. In this way, the estimator does not have an absolute guide, but rather a reasonable <strong>starting assumption</strong> that allows to counterbalance the lack of data.</p>
<p>Although the MLE approach seems plausible, it can be overly simplistic in many cases, whereas the Bayesian one is intrinsically more robust. As a consequence the <strong>Bayesian estimator is choosen</strong>.</p>
<p>There are several prior distribuitions available in pgmpy, a sensible choice of <strong>prior</strong> is the <strong>Bayesian Dirichlet equivalent uniform prior</strong> (BDeu). In the learning process, using BDeu, <strong>N uniform samples</strong> are <strong>generated</strong> for each variable to compute the pseudo-counts (default is N=5), hence the estimated probabilities in CPT are more conservative than the ones obtained through MLE (i.e. probabilities close to 1 or 0 get smoothed).</p>
<p>In the following cell the CPT are learned and displayed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianEstimator</span><span class="p">,</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.core.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="c1"># disable text wrapping in output cell</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;div.output_area pre {white-space: pre;}&lt;/style&gt;&quot;</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">cpds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
          <span class="n">estimator</span><span class="o">=</span><span class="n">BayesianEstimator</span><span class="p">,</span>
          <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;BDeu&quot;</span><span class="p">,</span>
          <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
          <span class="n">complete_samples_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Check model: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CPT of </span><span class="si">{</span><span class="n">cpd</span><span class="o">.</span><span class="n">variable</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cpd</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>div.output_area pre {white-space: pre;}</style></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Check model: True

CPT of Pop:
+------------------------+----------+
| Pop(A: -0.19 to +0.07) | 0.338164 |
+------------------------+----------+
| Pop(B: +0.07 to +0.50) | 0.338164 |
+------------------------+----------+
| Pop(C: +0.50 to +1.99) | 0.323671 |
+------------------------+----------+

CPT of EC:
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| GDP                    | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(A: -5.71 to +1.24) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(B: +1.24 to +2.89) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) | GDP(C: +2.89 to +7.49) |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| Pop                    | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(A: -0.19 to +0.07) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(B: +0.07 to +0.50) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) | Pop(C: +0.50 to +1.99) |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| Urb                    | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) | Urb(A: -0.02 to +0.15) | Urb(B: +0.15 to +0.82) | Urb(C: +0.82 to +2.84) |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| EC(A: -7.05 to -0.12)  | 0.9435028248587572     | 0.09009009009009006    | 0.3333333333333333     | 0.8198198198198197     | 0.6120943952802359     | 0.3333333333333333     | 0.3333333333333333     | 0.09009009009009006    | 0.9435028248587572     | 0.13421828908554573    | 0.3333333333333333     | 0.3333333333333333     | 0.05208333333333332    | 0.4858757062146893     | 0.8198198198198197     | 0.3333333333333333     | 0.3333333333333333     | 0.052083333333333336   | 0.02824858757062147    | 0.3333333333333333     | 0.3333333333333333     | 0.09009009009009009    | 0.3333333333333333     | 0.3333333333333333     | 0.3333333333333333     | 0.3333333333333333     | 0.010857763300760043   |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| EC(B: -0.12 to +2.79)  | 0.028248587570621472   | 0.8198198198198197     | 0.3333333333333333     | 0.09009009009009006    | 0.2536873156342183     | 0.3333333333333333     | 0.3333333333333333     | 0.8198198198198197     | 0.028248587570621472   | 0.7315634218289085     | 0.3333333333333333     | 0.3333333333333333     | 0.8958333333333333     | 0.4858757062146893     | 0.09009009009009006    | 0.3333333333333333     | 0.3333333333333333     | 0.052083333333333336   | 0.7146892655367232     | 0.3333333333333333     | 0.3333333333333333     | 0.09009009009009009    | 0.036630036630036625   | 0.3333333333333333     | 0.3333333333333333     | 0.3333333333333333     | 0.09880564603691641    |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+
| EC(C: +2.79 to +13.06) | 0.028248587570621472   | 0.09009009009009006    | 0.3333333333333333     | 0.09009009009009006    | 0.13421828908554573    | 0.3333333333333333     | 0.3333333333333333     | 0.09009009009009006    | 0.028248587570621472   | 0.13421828908554573    | 0.3333333333333333     | 0.3333333333333333     | 0.05208333333333332    | 0.02824858757062147    | 0.09009009009009006    | 0.3333333333333333     | 0.3333333333333333     | 0.8958333333333335     | 0.2570621468926554     | 0.3333333333333333     | 0.3333333333333333     | 0.8198198198198199     | 0.63003663003663       | 0.3333333333333333     | 0.3333333333333333     | 0.3333333333333333     | 0.8903365906623236     |
+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+------------------------+

CPT of Urb:
+------------------------+----------+
| Urb(A: -0.02 to +0.15) | 0.338164 |
+------------------------+----------+
| Urb(B: +0.15 to +0.82) | 0.338164 |
+------------------------+----------+
| Urb(C: +0.82 to +2.84) | 0.323671 |
+------------------------+----------+

CPT of GDP:
+------------------------+----------+
| GDP(A: -5.71 to +1.24) | 0.343137 |
+------------------------+----------+
| GDP(B: +1.24 to +2.89) | 0.328431 |
+------------------------+----------+
| GDP(C: +2.89 to +7.49) | 0.328431 |
+------------------------+----------+

CPT of FFEC:
+-------------------------+-----------------------+-----------------------+------------------------+
| EC                      | EC(A: -7.05 to -0.12) | EC(B: -0.12 to +2.79) | EC(C: +2.79 to +13.06) |
+-------------------------+-----------------------+-----------------------+------------------------+
| FFEC(A: -2.72 to -0.40) | 0.5870646766169154    | 0.3333333333333333    | 0.09895833333333334    |
+-------------------------+-----------------------+-----------------------+------------------------+
| FFEC(B: -0.40 to +0.16) | 0.36318407960199006   | 0.4270833333333333    | 0.19270833333333331    |
+-------------------------+-----------------------+-----------------------+------------------------+
| FFEC(C: +0.16 to +2.34) | 0.04975124378109453   | 0.23958333333333331   | 0.7083333333333334     |
+-------------------------+-----------------------+-----------------------+------------------------+

CPT of REC:
+--------------------------+-----------------------+-----------------------+------------------------+
| EC                       | EC(A: -7.05 to -0.12) | EC(B: -0.12 to +2.79) | EC(C: +2.79 to +13.06) |
+--------------------------+-----------------------+-----------------------+------------------------+
| REC(A: -14.97 to +2.03)  | 0.2028985507246377    | 0.49612403100775193   | 0.3958333333333333     |
+--------------------------+-----------------------+-----------------------+------------------------+
| REC(B: +2.03 to +11.51)  | 0.3333333333333333    | 0.2868217054263566    | 0.3958333333333333     |
+--------------------------+-----------------------+-----------------------+------------------------+
| REC(C: +11.51 to +23.95) | 0.463768115942029     | 0.2170542635658915    | 0.20833333333333331    |
+--------------------------+-----------------------+-----------------------+------------------------+

CPT of EI:
+-----------------------+-----------------------+-----------------------+------------------------+
| EC                    | EC(A: -7.05 to -0.12) | EC(B: -0.12 to +2.79) | EC(C: +2.79 to +13.06) |
+-----------------------+-----------------------+-----------------------+------------------------+
| EI(A: -3.27 to -0.38) | 0.6766169154228856    | 0.2864583333333333    | 0.052083333333333336   |
+-----------------------+-----------------------+-----------------------+------------------------+
| EI(B: -0.38 to +0.78) | 0.2288557213930348    | 0.4739583333333333    | 0.2864583333333333     |
+-----------------------+-----------------------+-----------------------+------------------------+
| EI(C: +0.78 to +5.75) | 0.09452736318407962   | 0.23958333333333331   | 0.6614583333333334     |
+-----------------------+-----------------------+-----------------------+------------------------+

CPT of CO2:
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| FFEC                    | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40)  | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16)  | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34)  |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| REC                     | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CO2(A: -10.20 to -0.79) | 0.3333333333333333      | 0.463768115942029       | 0.6991869918699187       | 0.3333333333333333      | 0.463768115942029       | 0.3333333333333333       | 0.11904761904761905     | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CO2(B: -0.79 to +3.81)  | 0.3333333333333333      | 0.463768115942029       | 0.26016260162601623      | 0.6145833333333334      | 0.463768115942029       | 0.3333333333333333       | 0.44047619047619047     | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CO2(C: +3.81 to +17.59) | 0.3333333333333333      | 0.07246376811594203     | 0.04065040650406504      | 0.052083333333333336    | 0.07246376811594203     | 0.3333333333333333       | 0.44047619047619047     | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+

CPT of CH4:
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| FFEC                   | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40)  | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16)  | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34)  |
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| REC                    | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) |
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CH4(A: -6.02 to -0.31) | 0.3333333333333333      | 0.5765765765765766      | 0.22424242424242424      | 0.855072463768116       | 0.6594202898550725      | 0.3333333333333333       | 0.761904761904762       | 0.3333333333333333      | 0.3333333333333333       |
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CH4(B: -0.31 to +2.11) | 0.3333333333333333      | 0.3333333333333333      | 0.7151515151515152       | 0.07246376811594203     | 0.2681159420289855      | 0.3333333333333333       | 0.11904761904761905     | 0.3333333333333333      | 0.3333333333333333       |
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| CH4(C: +2.11 to +9.00) | 0.3333333333333333      | 0.0900900900900901      | 0.06060606060606061      | 0.07246376811594203     | 0.07246376811594203     | 0.3333333333333333       | 0.11904761904761905     | 0.3333333333333333      | 0.3333333333333333       |
+------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+

CPT of N2O:
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| FFEC                    | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40) | FFEC(A: -2.72 to -0.40)  | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16) | FFEC(B: -0.40 to +0.16)  | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34) | FFEC(C: +0.16 to +2.34)  |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| REC                     | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) | REC(A: -14.97 to +2.03) | REC(B: +2.03 to +11.51) | REC(C: +11.51 to +23.95) |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| N2O(A: -4.31 to +0.61)  | 0.3333333333333333      | 0.5765765765765766      | 0.7151515151515152       | 0.463768115942029       | 0.07246376811594203     | 0.3333333333333333       | 0.11904761904761905     | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| N2O(B: +0.61 to +2.75)  | 0.3333333333333333      | 0.3333333333333333      | 0.06060606060606061      | 0.2681159420289855      | 0.6594202898550725      | 0.3333333333333333       | 0.11904761904761905     | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+
| N2O(C: +2.75 to +12.61) | 0.3333333333333333      | 0.0900900900900901      | 0.22424242424242424      | 0.2681159420289855      | 0.2681159420289855      | 0.3333333333333333       | 0.761904761904762       | 0.3333333333333333      | 0.3333333333333333       |
+-------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+

</pre></div></div>
</div>
<h2 id="Network-analysis">Network analysis<a class="headerlink" href="#Network-analysis" title="Link to this heading">¶</a></h2>
<p>Among all the features, in pgmpy it is possible to investigate several <strong>properties of the network</strong>. For instance, it is possible to check for <strong>conditional independencies</strong> and <strong>active trails</strong> with respect to some given evidence or to ask for the <strong>Markov blanket</strong> of a node.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There can be made </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">()</span><span class="o">.</span><span class="n">get_assertions</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
      <span class="s1">&#39;valid independence assertions with respect to the all possible given evidence.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;For instance, any node in the network is independent of its non-descendents given its parents (local semantics):</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">local_independencies</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">evidence</span><span class="p">):</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">active_trail_nodes</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">evidence</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">active</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">active</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">evidence</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active trails between </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> and </span><span class="si">{</span><span class="n">active</span><span class="si">}</span><span class="s1"> given the evidence </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Active trails between </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> and </span><span class="si">{</span><span class="n">active</span><span class="si">}</span><span class="s1"> given no evidence.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No active trails for </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> given the evidence </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">evidence</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">markov_blanket_of</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Markov blanket of </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> is </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_markov_blanket</span><span class="p">(</span><span class="n">node</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[])</span>
<span class="n">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
<span class="n">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">])</span>
<span class="n">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;EI&#39;</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
<span class="n">active_trails_of</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s1">&#39;CH4&#39;</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;FFEC&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">markov_blanket_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s1">&#39;Pop&#39;</span><span class="p">)</span>
<span class="n">markov_blanket_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s1">&#39;EC&#39;</span><span class="p">)</span>
<span class="n">markov_blanket_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s1">&#39;REC&#39;</span><span class="p">)</span>
<span class="n">markov_blanket_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="s1">&#39;CH4&#39;</span><span class="p">)</span> <span class="c1"># note: a bug in pgmpy 0.1.10 raise a KeyError here.</span>
                              <span class="c1"># I opened an issue and I got accepted my pull request with the bug fix:</span>
                              <span class="c1"># https://github.com/pgmpy/pgmpy/issues/1293</span>
                              <span class="c1"># https://github.com/pgmpy/pgmpy/pull/1294</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There can be made 2759 valid independence assertions with respect to the all possible given evidence.
For instance, any node in the network is independent of its non-descendents given its parents (local semantics):

(Pop _|_ GDP, Urb)
(Urb _|_ Pop, GDP)
(GDP _|_ Pop, Urb)
(FFEC _|_ EI, Pop, REC, GDP, Urb | EC)
(REC _|_ EI, Pop, FFEC, GDP, Urb | EC)
(EI _|_ N2O, REC, GDP, Urb, CO2, Pop, FFEC, CH4 | EC)
(CO2 _|_ N2O, EI, Pop, Urb, GDP, CH4, EC | FFEC, REC)
(CH4 _|_ N2O, EI, Pop, Urb, GDP, CO2, EC | FFEC, REC)
(N2O _|_ EI, Pop, Urb, GDP, CO2, CH4, EC | FFEC, REC)

Active trails between &#39;FFEC&#39; and {&#39;N2O&#39;, &#39;REC&#39;, &#39;Urb&#39;, &#39;GDP&#39;, &#39;CO2&#39;, &#39;EI&#39;, &#39;Pop&#39;, &#39;CH4&#39;, &#39;EC&#39;} given no evidence.
Active trails between &#39;FFEC&#39; and {&#39;CO2&#39;, &#39;CH4&#39;, &#39;N2O&#39;} given the evidence {&#39;EC&#39;}.
Active trails between &#39;FFEC&#39; and {&#39;CH4&#39;, &#39;N2O&#39;, &#39;REC&#39;} given the evidence {&#39;CO2&#39;, &#39;EC&#39;}.
No active trails for &#39;EI&#39; given the evidence {&#39;EC&#39;}.
Active trails between &#39;CH4&#39; and {&#39;CO2&#39;, &#39;N2O&#39;, &#39;REC&#39;} given the evidence {&#39;FFEC&#39;, &#39;EC&#39;}.

Markov blanket of &#39;Pop&#39; is {&#39;Urb&#39;, &#39;GDP&#39;, &#39;EC&#39;}
Markov blanket of &#39;EC&#39; is {&#39;REC&#39;, &#39;GDP&#39;, &#39;Urb&#39;, &#39;EI&#39;, &#39;Pop&#39;, &#39;FFEC&#39;}
Markov blanket of &#39;REC&#39; is {&#39;N2O&#39;, &#39;CO2&#39;, &#39;FFEC&#39;, &#39;CH4&#39;, &#39;EC&#39;}
Markov blanket of &#39;CH4&#39; is {&#39;FFEC&#39;, &#39;REC&#39;}
</pre></div></div>
</div>
<p>The <strong>independence assertions</strong>, such as <span class="math notranslate nohighlight">\((A \perp B | C)\)</span>, are implemented in pgmpy with the class <code class="docutils literal notranslate"><span class="pre">IndependenceAssertion</span></code>, which has 3 fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">event1</span></code>: random variable which is independent (<span class="math notranslate nohighlight">\(A\)</span> in the example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event2</span></code>: random variables from which <code class="docutils literal notranslate"><span class="pre">event1</span></code> is independent (<span class="math notranslate nohighlight">\(B\)</span> in the example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">event3</span></code>: random variables given which <code class="docutils literal notranslate"><span class="pre">event1</span></code> is independent of <code class="docutils literal notranslate"><span class="pre">event2</span></code> (<span class="math notranslate nohighlight">\(C\)</span> in the example).</p></li>
</ul>
<p>In the following cell it is evaluated which are the nodes that have the maximum and the minimum number of appearance in independence assertions as independent variable or evidence. It can be notice that the closer a node is to the <em>core</em> of the network, the less are the independence assertions in which it is the independent variable and the more are the ones in which it is given as evidence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">independent_assertions_score_function</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">()</span><span class="o">.</span><span class="n">get_assertions</span><span class="p">()</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">event1</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evidence_assertions_score_function</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">()</span><span class="o">.</span><span class="n">get_assertions</span><span class="p">()</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">event3</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">assertion_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">score_function</span><span class="p">):</span>
    <span class="n">tmp_score</span> <span class="o">=</span> <span class="n">score_function</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tmp_score</span> <span class="o">==</span> <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]:</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tmp_score</span> <span class="o">&gt;</span> <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]:</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_score</span>
    <span class="k">if</span> <span class="n">tmp_score</span> <span class="o">==</span> <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]:</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tmp_score</span> <span class="o">&lt;</span> <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]:</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="n">assertion_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_score</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">independent_init</span> <span class="o">=</span> <span class="n">independent_assertions_score_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">independent_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">independent_init</span><span class="p">},</span>
                       <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">independent_init</span><span class="p">}}</span>
    <span class="n">evidence_init</span> <span class="o">=</span> <span class="n">evidence_assertions_score_function</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">evidence_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">evidence_init</span><span class="p">},</span>
                    <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">evidence_init</span><span class="p">}}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">update</span><span class="p">(</span><span class="n">independent_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">independent_assertions_score_function</span><span class="p">)</span>
        <span class="n">update</span><span class="p">(</span><span class="n">evidence_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">evidence_assertions_score_function</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nodes which appear most (</span><span class="si">{</span><span class="n">independent_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> times) in independence assertions&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;as independent variable are:</span><span class="se">\n</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">independent_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nodes which appear least (</span><span class="si">{</span><span class="n">independent_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> times) in independence assertions&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;as independent variable are:</span><span class="se">\n</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">independent_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nodes which appear most (</span><span class="si">{</span><span class="n">evidence_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> times) in independence assertions&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;as evidence are:</span><span class="se">\n</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">evidence_dict</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nodes which appear least (</span><span class="si">{</span><span class="n">evidence_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;score&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> times) in independence assertions&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;as evidence are:</span><span class="se">\n</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">evidence_dict</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">][</span><span class="s2">&quot;nodes&quot;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Nodes which appear most (311 times) in independence assertions as independent variable are:
{&#39;EI&#39;, &#39;Pop&#39;, &#39;GDP&#39;, &#39;Urb&#39;}
Nodes which appear least (112 times) in independence assertions as independent variable are:
{&#39;EC&#39;}
Nodes which appear most (2222 times) in independence assertions as evidence are:
{&#39;EC&#39;}
Nodes which appear least (1179 times) in independence assertions as evidence are:
{&#39;EI&#39;}
</pre></div></div>
</div>
<p>Some queries on independence assertions are proposed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.independencies.Independencies</span><span class="w"> </span><span class="kn">import</span> <span class="n">IndependenceAssertion</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="p">,</span> <span class="n">from_variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">):</span>
    <span class="n">assertion</span> <span class="o">=</span> <span class="n">IndependenceAssertion</span><span class="p">(</span><span class="n">independent</span><span class="p">,</span> <span class="n">from_variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">()</span><span class="o">.</span><span class="n">get_assertions</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">assertion</span><span class="o">.</span><span class="n">event1</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">event1</span> <span class="ow">and</span> <span class="n">assertion</span><span class="o">.</span><span class="n">event2</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="o">.</span><span class="n">event2</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">assertion</span><span class="o">.</span><span class="n">event3</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">event3</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">assertion</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EI&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N2O&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EI&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FFEC&quot;</span><span class="p">,</span> <span class="s2">&quot;REC&quot;</span><span class="p">,</span> <span class="s2">&quot;GDP&quot;</span><span class="p">,</span> <span class="s2">&quot;Pop&quot;</span><span class="p">,</span> <span class="s2">&quot;Urb&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CH4&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CH4&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;REC&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;REC&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">])</span>
<span class="n">check_assertion</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span> <span class="n">from_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CO2&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(EI _|_ N2O | EC): True
(EI _|_ REC, Urb, GDP, Pop, FFEC | EC): True
(EC _|_ CH4 | FFEC): False
(EC _|_ CH4 | FFEC, REC): True
(FFEC _|_ REC | EC): True
(FFEC _|_ REC | CO2, EC): False
(CH4 _|_ CO2 | FFEC): False
(CH4 _|_ CO2 | FFEC, REC): True
</pre></div></div>
</div>
<h2 id="Inferences">Inferences<a class="headerlink" href="#Inferences" title="Link to this heading">¶</a></h2>
<p>In pgmpy it is possible to perform <strong>inference</strong> on a Bayesian network through the <strong>Variable Elimination method</strong>. The <strong>elimination order</strong> is evaluated through <strong>heuristic functions</strong>, which assign an elimination cost to each node that has to be removed (i.e. to each node apart from the query nodes and the evidence nodes). The variable elimination algorithm is then executed accordingly with the assigned node costs.</p>
<p>The <a class="reference external" href="https://pgmpy.org/inference.html#module-pgmpy.inference.EliminationOrder">available heuristic functions</a> assign the cost of a node as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MinFill</span></code>: the number of edges that need to be added to the graph due to its elimination.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MinNeighbors</span></code>: the number of neighbors it has in the current graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MinWeight</span></code>: the product of weights, domain cardinality, of its neighbors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WeightedMinFill</span></code>: the sum of weights of the edges that need to be added to the graph due to its elimination, where a weight of an edge is the product of the weights, domain cardinality, of its constituent vertices.</p></li>
</ul>
<p>The following cell is dedicated to inference queries and experiments on the cost heuristic functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.inference</span><span class="w"> </span><span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="s2">&quot;MinFill&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">desc</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span>
                      <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">,</span>
                      <span class="n">elimination_order</span><span class="o">=</span><span class="n">elimination_order</span><span class="p">,</span>
                      <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--- Query executed in </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s1">0,.4f</span><span class="si">}</span><span class="s1"> seconds ---</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="s2">&quot;MinFill&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="n">infer</span><span class="o">.</span><span class="n">_get_elimination_order</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span>
                                        <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">,</span>
                                        <span class="n">elimination_order</span><span class="o">=</span><span class="n">elimination_order</span><span class="p">,</span>
                                        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">desc</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">ordering</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--- Ordering found in </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s1">0,.4f</span><span class="si">}</span><span class="s1"> seconds ---</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ordering</span>

<span class="k">def</span><span class="w"> </span><span class="nf">padding</span><span class="p">(</span><span class="n">heuristic</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">heuristic</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compare_all_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">ord_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;MinFill&quot;</span><span class="p">:</span> <span class="n">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="s2">&quot;MinFill&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">),</span>
        <span class="s2">&quot;MinNeighbors&quot;</span><span class="p">:</span> <span class="n">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="s2">&quot;MinNeighbors&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">),</span>
        <span class="s2">&quot;MinWeight&quot;</span><span class="p">:</span> <span class="n">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="s2">&quot;MinWeight&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">),</span>
        <span class="s2">&quot;WeightedMinFill&quot;</span><span class="p">:</span> <span class="n">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="s2">&quot;WeightedMinFill&quot;</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">evidence</span><span class="p">:</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;elimination order found for probability query of </span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s1"> with no evidence:&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;elimination order found for probability query of </span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s1"> with evidence </span><span class="si">{</span><span class="n">evidence</span><span class="si">}</span><span class="s1">:&#39;</span>
    <span class="k">if</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinFill&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinNeighbors&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinFill&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinWeight&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinFill&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;WeightedMinFill&quot;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All heuristics find the same </span><span class="si">{</span><span class="n">pre</span><span class="si">}</span><span class="s1">.</span><span class="se">\n</span><span class="si">{</span><span class="n">ord_dict</span><span class="p">[</span><span class="s2">&quot;MinFill&quot;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Different </span><span class="si">{</span><span class="n">pre</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">heuristic</span><span class="p">,</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">ord_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">padding</span><span class="p">(</span><span class="n">heuristic</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

<span class="n">infer</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GDP&#39;</span><span class="p">]</span>
<span class="n">heuristic</span> <span class="o">=</span> <span class="s2">&quot;MinNeighbors&quot;</span>
<span class="n">ordering</span> <span class="o">=</span> <span class="n">get_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="n">heuristic</span><span class="p">,</span>
                        <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Elimination order for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> with no evidence computed through </span><span class="si">{</span><span class="n">heuristic</span><span class="si">}</span><span class="s1"> heuristic:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="n">ordering</span><span class="p">,</span>
             <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Probability query of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> with no evidence through precomputed elimination order:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">ordering</span><span class="p">)),</span>
             <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Probability query of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> with no evidence through dummy elimination order:&#39;</span><span class="p">)</span>
<span class="n">compare_all_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>

<span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span>
<span class="n">ev</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;EC&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -7.05 to -0.12&#39;</span><span class="p">}</span>
<span class="n">heuristic</span> <span class="o">=</span> <span class="s2">&quot;MinFill&quot;</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="n">heuristic</span><span class="p">,</span>
             <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Probability query of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> with evidence </span><span class="si">{</span><span class="n">ev</span><span class="si">}</span><span class="s1"> computed through </span><span class="si">{</span><span class="n">heuristic</span><span class="si">}</span><span class="s1"> heuristic:&#39;</span><span class="p">)</span>
<span class="n">compare_all_ordering</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">ev</span><span class="p">)</span>
<span class="n">heuristic</span> <span class="o">=</span> <span class="s2">&quot;MinNeighbors&quot;</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">evidence</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="n">elimination_order</span><span class="o">=</span><span class="n">heuristic</span><span class="p">,</span>
             <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Probability query of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> with evidence </span><span class="si">{</span><span class="n">ev</span><span class="si">}</span><span class="s1"> computed through </span><span class="si">{</span><span class="n">heuristic</span><span class="si">}</span><span class="s1"> heuristic:&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Elimination order for [&#39;GDP&#39;] with no evidence computed through MinNeighbors heuristic:
[&#39;EI&#39;, &#39;N2O&#39;, &#39;CO2&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;Urb&#39;, &#39;Pop&#39;, &#39;EC&#39;]
--- Ordering found in 0.0022 seconds ---

Probability query of [&#39;GDP&#39;] with no evidence through precomputed elimination order:
+------------------------+------------+
| GDP                    |   phi(GDP) |
+========================+============+
| GDP(A: -5.71 to +1.24) |     0.3431 |
+------------------------+------------+
| GDP(B: +1.24 to +2.89) |     0.3284 |
+------------------------+------------+
| GDP(C: +2.89 to +7.49) |     0.3284 |
+------------------------+------------+
--- Query executed in 0.0196 seconds ---

Probability query of [&#39;GDP&#39;] with no evidence through dummy elimination order:
+------------------------+------------+
| GDP                    |   phi(GDP) |
+========================+============+
| GDP(A: -5.71 to +1.24) |     0.3431 |
+------------------------+------------+
| GDP(B: +1.24 to +2.89) |     0.3284 |
+------------------------+------------+
| GDP(C: +2.89 to +7.49) |     0.3284 |
+------------------------+------------+
--- Query executed in 0.1300 seconds ---

Different elimination order found for probability query of [&#39;GDP&#39;] with no evidence:
MinFill:         [&#39;N2O&#39;, &#39;Urb&#39;, &#39;CO2&#39;, &#39;REC&#39;, &#39;EI&#39;, &#39;Pop&#39;, &#39;FFEC&#39;, &#39;CH4&#39;, &#39;EC&#39;]
MinNeighbors:    [&#39;EI&#39;, &#39;N2O&#39;, &#39;CO2&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;Urb&#39;, &#39;Pop&#39;, &#39;EC&#39;]
MinWeight:       [&#39;EI&#39;, &#39;N2O&#39;, &#39;CO2&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;Urb&#39;, &#39;Pop&#39;, &#39;EC&#39;]
WeightedMinFill: [&#39;EI&#39;, &#39;N2O&#39;, &#39;CO2&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;Urb&#39;, &#39;Pop&#39;, &#39;EC&#39;]

Probability query of [&#39;CO2&#39;] with evidence {&#39;EC&#39;: &#39;A: -7.05 to -0.12&#39;} computed through MinFill heuristic:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.4721 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.3765 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.1514 |
+-------------------------+------------+
--- Query executed in 0.0237 seconds ---

Different elimination order found for probability query of [&#39;CO2&#39;] with evidence {&#39;EC&#39;: &#39;A: -7.05 to -0.12&#39;}:
MinFill:         [&#39;N2O&#39;, &#39;GDP&#39;, &#39;Urb&#39;, &#39;EI&#39;, &#39;Pop&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;]
MinNeighbors:    [&#39;EI&#39;, &#39;N2O&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;GDP&#39;, &#39;Urb&#39;, &#39;Pop&#39;]
MinWeight:       [&#39;EI&#39;, &#39;N2O&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;GDP&#39;, &#39;Urb&#39;, &#39;Pop&#39;]
WeightedMinFill: [&#39;EI&#39;, &#39;N2O&#39;, &#39;CH4&#39;, &#39;REC&#39;, &#39;FFEC&#39;, &#39;GDP&#39;, &#39;Urb&#39;, &#39;Pop&#39;]

Probability query of [&#39;CO2&#39;] with evidence {&#39;EC&#39;: &#39;A: -7.05 to -0.12&#39;} computed through MinNeighbors heuristic:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.4721 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.3765 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.1514 |
+-------------------------+------------+
--- Query executed in 0.0302 seconds ---

</pre></div></div>
</div>
<p>This last part of this document try to answer to some <strong>key questions</strong> using probability queries about the greenhouse gases scenario:</p>
<ul class="simple">
<li><p>a considerable population growth lead to an increase of energy consumption and CO2 diffusion</p></li>
<li><p>an increase of urbanization growth rate and GDP per capita are important factors in CO2 diffusion</p></li>
<li><p>energy consumption reduction lead to CO2 diffusion reduction</p></li>
<li><p>an increase of CO2 diffusion is evidence of an increase of CH4 and N2O diffusion</p></li>
<li><p>a reduction of CO2 diffusion is evidence of a reduction of CH4 and N2O diffusion</p></li>
<li><p>fossil fuel consumption reduction and renewable energy consumption increase impact significantly on greenhouse gases diffusion.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Pop&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +0.50 to +1.99&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of energy consumption increase with population growth over +0.50%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Pop&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +0.50 to +1.99&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with population growth over +0.50%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Urb&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +0.82 to +2.84&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with urbanization growth over +0.82%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;GDP&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +2.89 to +7.49&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with GDP per capita growth over +2.89%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span>
             <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Pop&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +0.50 to +1.99&#39;</span><span class="p">,</span> <span class="s1">&#39;Urb&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +0.82 to +2.84&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +2.89 to +7.49&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with:</span><span class="se">\n</span><span class="s1"> - population growth over +0.50%</span><span class="se">\n</span><span class="s1"> - urbanization growth over +0.82%</span><span class="se">\n</span><span class="s1"> - GDP per capita growth over +2.89%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EC&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -7.05 to -0.12&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with energy consumption growth under -0.12%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EC&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +2.79 to +13.06&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with energy consumption growth over +2.79%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +3.81 to +17.59&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CH4 increase with CO2 growth over +3.81%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -10.20 to -0.79&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CH4 increase with CO2 growth under -0.79%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CH4 increase with no given evidence:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N2O&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +3.81 to +17.59&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of N2O increase with CO2 growth over +3.81%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N2O&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -10.20 to -0.79&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of N2O increase with CO2 growth under -0.79%:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N2O&#39;</span><span class="p">],</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of N2O increase with no given evidence:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FFEC&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">],</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Joint probability of fossil fuel energy consumption and renewable energy consumption:&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FFEC&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -2.72 to -0.40&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +11.51 to +23.95&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CO2 increase with:</span><span class="se">\n</span><span class="s1"> - fossil fuel energy consumption growth under -0.40%</span><span class="se">\n</span><span class="s1"> - renewable energy consumption growth over +11.51%&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FFEC&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -2.72 to -0.40&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +11.51 to +23.95&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of CH4 increase with:</span><span class="se">\n</span><span class="s1"> - fossil fuel energy consumption growth under -0.40%</span><span class="se">\n</span><span class="s1"> - renewable energy consumption growth over +11.51%&#39;</span><span class="p">)</span>
<span class="n">query_report</span><span class="p">(</span><span class="n">infer</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N2O&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FFEC&#39;</span><span class="p">:</span> <span class="s1">&#39;A: -2.72 to -0.40&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">:</span> <span class="s1">&#39;C: +11.51 to +23.95&#39;</span><span class="p">},</span>
             <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Probability of N2O increase with:</span><span class="se">\n</span><span class="s1"> - fossil fuel energy consumption growth under -0.40%</span><span class="se">\n</span><span class="s1"> - renewable energy consumption growth over +11.51%&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Probability of energy consumption increase with population growth over +0.50%:
+------------------------+-----------+
| EC                     |   phi(EC) |
+========================+===========+
| EC(A: -7.05 to -0.12)  |    0.3087 |
+------------------------+-----------+
| EC(B: -0.12 to +2.79)  |    0.3011 |
+------------------------+-----------+
| EC(C: +2.79 to +13.06) |    0.3902 |
+------------------------+-----------+
--- Query executed in 0.0331 seconds ---

Probability of CO2 increase with population growth over +0.50%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.3704 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.4008 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.2288 |
+-------------------------+------------+
--- Query executed in 0.0276 seconds ---

Probability of CO2 increase with urbanization growth over +0.82%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.3793 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.3965 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.2242 |
+-------------------------+------------+
--- Query executed in 0.0253 seconds ---

Probability of CO2 increase with GDP per capita growth over +2.89%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.3570 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.4021 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.2409 |
+-------------------------+------------+
--- Query executed in 0.0234 seconds ---

Probability of CO2 increase with:
 - population growth over +0.50%
 - urbanization growth over +0.82%
 - GDP per capita growth over +2.89%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.3044 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.4011 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.2945 |
+-------------------------+------------+
--- Query executed in 0.0251 seconds ---

Probability of CO2 increase with energy consumption growth under -0.12%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.4721 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.3765 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.1514 |
+-------------------------+------------+
--- Query executed in 0.0320 seconds ---

Probability of CO2 increase with energy consumption growth over +2.79%:
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.2959 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.3984 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.3058 |
+-------------------------+------------+
--- Query executed in 0.0295 seconds ---

Probability of CH4 increase with CO2 growth over +3.81%:
+------------------------+------------+
| CH4                    |   phi(CH4) |
+========================+============+
| CH4(A: -6.02 to -0.31) |     0.4789 |
+------------------------+------------+
| CH4(B: -0.31 to +2.11) |     0.2765 |
+------------------------+------------+
| CH4(C: +2.11 to +9.00) |     0.2446 |
+------------------------+------------+
--- Query executed in 0.0279 seconds ---

Probability of CH4 increase with CO2 growth under -0.79%:
+------------------------+------------+
| CH4                    |   phi(CH4) |
+========================+============+
| CH4(A: -6.02 to -0.31) |     0.4573 |
+------------------------+------------+
| CH4(B: -0.31 to +2.11) |     0.3776 |
+------------------------+------------+
| CH4(C: +2.11 to +9.00) |     0.1650 |
+------------------------+------------+
--- Query executed in 0.0219 seconds ---

Probability of CH4 increase with no given evidence:
+------------------------+------------+
| CH4                    |   phi(CH4) |
+========================+============+
| CH4(A: -6.02 to -0.31) |     0.5014 |
+------------------------+------------+
| CH4(B: -0.31 to +2.11) |     0.3155 |
+------------------------+------------+
| CH4(C: +2.11 to +9.00) |     0.1831 |
+------------------------+------------+
--- Query executed in 0.0198 seconds ---

Probability of N2O increase with CO2 growth over +3.81%:
+-------------------------+------------+
| N2O                     |   phi(N2O) |
+=========================+============+
| N2O(A: -4.31 to +0.61)  |     0.2901 |
+-------------------------+------------+
| N2O(B: +0.61 to +2.75)  |     0.2807 |
+-------------------------+------------+
| N2O(C: +2.75 to +12.61) |     0.4292 |
+-------------------------+------------+
--- Query executed in 0.0220 seconds ---

Probability of N2O increase with CO2 growth under -0.79%:
+-------------------------+------------+
| N2O                     |   phi(N2O) |
+=========================+============+
| N2O(A: -4.31 to +0.61)  |     0.4274 |
+-------------------------+------------+
| N2O(B: +0.61 to +2.75)  |     0.2968 |
+-------------------------+------------+
| N2O(C: +2.75 to +12.61) |     0.2758 |
+-------------------------+------------+
--- Query executed in 0.0223 seconds ---

Probability of N2O increase with no given evidence:
+-------------------------+------------+
| N2O                     |   phi(N2O) |
+=========================+============+
| N2O(A: -4.31 to +0.61)  |     0.3699 |
+-------------------------+------------+
| N2O(B: +0.61 to +2.75)  |     0.2982 |
+-------------------------+------------+
| N2O(C: +2.75 to +12.61) |     0.3319 |
+-------------------------+------------+
--- Query executed in 0.0209 seconds ---

Joint probability of fossil fuel energy consumption and renewable energy consumption:
+--------------------------+-------------------------+-----------------+
| REC                      | FFEC                    |   phi(REC,FFEC) |
+==========================+=========================+=================+
| REC(A: -14.97 to +2.03)  | FFEC(A: -2.72 to -0.40) |          0.1110 |
+--------------------------+-------------------------+-----------------+
| REC(A: -14.97 to +2.03)  | FFEC(B: -0.40 to +0.16) |          0.1221 |
+--------------------------+-------------------------+-----------------+
| REC(A: -14.97 to +2.03)  | FFEC(C: +0.16 to +2.34) |          0.1290 |
+--------------------------+-------------------------+-----------------+
| REC(B: +2.03 to +11.51)  | FFEC(A: -2.72 to -0.40) |          0.1141 |
+--------------------------+-------------------------+-----------------+
| REC(B: +2.03 to +11.51)  | FFEC(B: -0.40 to +0.16) |          0.1081 |
+--------------------------+-------------------------+-----------------+
| REC(B: +2.03 to +11.51)  | FFEC(C: +0.16 to +2.34) |          0.1140 |
+--------------------------+-------------------------+-----------------+
| REC(C: +11.51 to +23.95) | FFEC(A: -2.72 to -0.40) |          0.1276 |
+--------------------------+-------------------------+-----------------+
| REC(C: +11.51 to +23.95) | FFEC(B: -0.40 to +0.16) |          0.1037 |
+--------------------------+-------------------------+-----------------+
| REC(C: +11.51 to +23.95) | FFEC(C: +0.16 to +2.34) |          0.0705 |
+--------------------------+-------------------------+-----------------+
--- Query executed in 0.0218 seconds ---

Probability of CO2 increase with:
 - fossil fuel energy consumption growth under -0.40%
 - renewable energy consumption growth over +11.51%
+-------------------------+------------+
| CO2                     |   phi(CO2) |
+=========================+============+
| CO2(A: -10.20 to -0.79) |     0.6992 |
+-------------------------+------------+
| CO2(B: -0.79 to +3.81)  |     0.2602 |
+-------------------------+------------+
| CO2(C: +3.81 to +17.59) |     0.0407 |
+-------------------------+------------+
--- Query executed in 0.0250 seconds ---

Probability of CH4 increase with:
 - fossil fuel energy consumption growth under -0.40%
 - renewable energy consumption growth over +11.51%
+------------------------+------------+
| CH4                    |   phi(CH4) |
+========================+============+
| CH4(A: -6.02 to -0.31) |     0.2242 |
+------------------------+------------+
| CH4(B: -0.31 to +2.11) |     0.7152 |
+------------------------+------------+
| CH4(C: +2.11 to +9.00) |     0.0606 |
+------------------------+------------+
--- Query executed in 0.0239 seconds ---

Probability of N2O increase with:
 - fossil fuel energy consumption growth under -0.40%
 - renewable energy consumption growth over +11.51%
+-------------------------+------------+
| N2O                     |   phi(N2O) |
+=========================+============+
| N2O(A: -4.31 to +0.61)  |     0.7152 |
+-------------------------+------------+
| N2O(B: +0.61 to +2.75)  |     0.0606 |
+-------------------------+------------+
| N2O(C: +2.75 to +12.61) |     0.2242 |
+-------------------------+------------+
--- Query executed in 0.0273 seconds ---

</pre></div></div>
</div>
<p>We can get the following <strong>outcomes</strong> from the queries on the modelled Bayesian network:</p>
<ul class="simple">
<li><p><strong>Energy consumption vs Population, Urbanization, GDP</strong>: the increase of gases diffusion is more clearly proportional to energy consumption growth rather than population, urbanization or GDP per capita growth. This result can be a symptom that some important casual factors of the energy consumption growth strictly correlated with greenhouse gases diffusion, such as industrialization, are not represented into the network.</p></li>
<li><p>N2O vs CH4: N2O growth trends almost resemble the ones of CO2, whereas the CH4 growth seems very likely to decrease regardless of the evidence. This is unlikely to be the real situation, and the probability query of CH4 without given evidence proves it: the lower tier ‘A’ is much more likely than the others, and that is a consequence of data sparsity. The other 2 tiers of CH4 are underrepresented. That is not the case of N2O, whose tiers are more balanced.</p></li>
<li><p><strong>Fossil fuel vs Renewable</strong>: finally and most importantly, the output probabilites of the last queries suggest that the reduction of fossil fuel energy consumption and the increase of renewable energy consumption are really effective strategies to minimize greenhouse gases emissions, hence it is really important to use sustainable energies.</p></li>
</ul>
<p>[1] <a class="reference external" href="https://www.epa.gov/ghgemissions/overview-greenhouse-gases">U.S. Environmental Protection Agency - Greenhouse Gas Emissions</a></p>
<p>[2] <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0950705110000110">Didem Cinar, Gulgun Kayakutlu - Scenario analysis using Bayesian networks: A case study in energy sector</a></p>
<p>[3] <a class="reference external" href="https://data.worldbank.org/indicator">World Bank Open Data</a></p>







  
  






                
  <div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="stickybox"></div>
  <script>
    (function() {
      var nav = document.querySelector('.md-header__inner');
      if (!nav) return;

      var socialDiv = document.createElement('div');
      socialDiv.className = 'md-header__social';

      socialDiv.innerHTML =
        '<a href="https://github.com/pgmpy/pgmpy" target="_blank" rel="noopener" title="GitHub">' +
          '<svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.8-14.9-112.8-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://discord.gg/DRkdKaumBs" target="_blank" rel="noopener" title="Discord">' +
          '<svg viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91A483.689 483.689 0 0 0 116.085 69.137a1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375A487.666 487.666 0 0 0 176.02 479.918a1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665 0 53.306 26.82 52.843 59.239C275.334 310.993 251.924 337.58 222.491 337.58zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667 0 53.307 26.82 52.844 59.239C470.715 310.993 447.538 337.58 417.871 337.58z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://www.linkedin.com/company/pgmpy/" target="_blank" rel="noopener" title="LinkedIn">' +
          '<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/>' +
          '</svg>' +
        '</a>';

      nav.appendChild(socialDiv);
    })();
  </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, Ankur Ankan.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    9.1.0.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "1.0.0 (stable)", "version": "https://pgmpy.org"}, {"aliases": [], "title": "dev", "version": "https://pgmpy.org/dev"}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>
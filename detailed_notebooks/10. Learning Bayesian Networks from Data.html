


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html">
      
      
        <link rel="next" href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html">
      
      
      <link rel="icon" href="../_static/logo_favi.ico">
    
    
      
        <title>Learning Bayesian Networks from Data - pgmpy</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.553f2186060d16162.min.css?v=c794c0f9" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0be4c15b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  <!-- SEO meta tags -->
  <meta name="description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="keywords" content="pgmpy, Bayesian Networks, causal inference, probabilistic graphical models, structure learning, parameter estimation, Python">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="pgmpy">
  <meta property="og:title" content="Learning Bayesian Networks from Data">
  <meta property="og:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta property="og:url" content="https://pgmpy.org/detailed_notebooks/10.%20Learning%20Bayesian%20Networks%20from%20Data.html">
  <meta property="og:image" content="https://pgmpy.org/_static/logo.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Learning Bayesian Networks from Data">
  <meta name="twitter:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="twitter:image" content="https://pgmpy.org/_static/logo.png">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HCFR07M31W');
  </script>
  <!-- EthicalAds -->
  <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
  <!-- Header social links styling -->
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500;600&display=swap");
    :root {
      --md-text-font: "Source Sans 3", system-ui, sans-serif;
      --md-code-font: "Source Code Pro", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .md-header__social {
      display: flex;
      align-items: center;
      gap: 0.1rem;
      margin-left: 0.4rem;
    }
    .md-header__social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem;
      color: var(--md-default-fg-color--light);
      opacity: 0.7;
      transition: opacity 0.25s;
    }
    .md-header__social a:hover {
      opacity: 1;
    }
    .md-header__social svg {
      width: 1.2rem;
      height: 1.2rem;
      fill: currentColor;
    }
    [data-md-color-scheme="slate"] .md-header__social a {
      color: var(--md-default-fg-color--light);
    }
    /* Card visibility in light/dark modes */
    .sd-card {
      background-color: var(--pgmpy-card-bg, var(--md-default-bg-color));
      border: 1px solid var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }
    .sd-card .sd-card-header,
    .sd-card .sd-card-footer {
      border-color: var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
    }
    [data-md-color-scheme="slate"] .sd-card {
      --pgmpy-card-bg: rgba(255, 255, 255, 0.045);
      --pgmpy-card-border: rgba(255, 255, 255, 0.2);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
    }
    /* Hover shadow effect on feature cards */
    .sd-card-hover {
      transition: box-shadow 0.25s ease, transform 0.25s ease;
    }
    .sd-card-hover:hover {
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }
    [data-md-color-scheme="slate"] .sd-card-hover:hover {
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.55);
    }
    /* Center content when right sidebar (toc) is hidden */
    .md-sidebar--secondary[hidden] ~ .md-content {
      margin-left: auto;
      margin-right: auto;
    }
  </style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Parameter-Learning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="pgmpy" class="md-header__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pgmpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Learning Bayesian Networks from Data
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../started/base.html" class="md-tabs__link">
        
  
    
  
  <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../documentation.html" class="md-tabs__link">
        
  
    
  
  <span title="/documentation.rst (reference label)"><span>Documentation</span></span>

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../examples.html" class="md-tabs__link">
        
  
    
  
  <span title="/examples.rst (reference label)"><span>Examples</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api.html" class="md-tabs__link">
        
  
    
  
  <span title="/api.rst (reference label)"><span>API Reference</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../citation.html" class="md-tabs__link">
        
  
    
  
  <span title="/citation.rst (reference label)"><span>Citation</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development.html" class="md-tabs__link">
        
  
    
  
  <span title="/development.rst (reference label)"><span>Getting Involved</span></span>

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="pgmpy" class="md-nav__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    pgmpy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../started/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/documentation.rst (reference label)"><span>Documentation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html#tutorial-notebooks" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_discrete_bn.ipynb (reference label)"><span>Creating Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Linear_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_linear_bn.ipynb (reference label)"><span>Creating Linear Gaussian Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Defining_CPDs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/defining_cpds.ipynb (reference label)"><span>How to define Tabular<wbr>CPD and Linear<wbr>Gaussian<wbr>CPD</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Basic_Operations_on_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/basic_operations_on_bn.ipynb (reference label)"><span>Basic Operations on Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning.ipynb (reference label)"><span>Structure Learning in Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_Chow_Liu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_chow_liu.ipynb (reference label)"><span>Learning Tree Structure from Data using the Chow-<wbr>Liu Algorithm</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_TAN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_tan.ipynb (reference label)"><span>Learning Tree-<wbr>augmented Naive Bayes <wbr>(TAN) Structure from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Expert_Knowledge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/expert_knowledge.ipynb (reference label)"><span>Expert Knowledge Integration with Causal Discovery</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_discrete_bn.ipynb (reference label)"><span>Parameter Learning in Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb (reference label)"><span>Marginal Learning in Discrete Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html#Modeling-the-home-&-visitor-scores" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb#modeling-the-home-&amp;-visitor-scores (reference label)"><span>Modeling the home &amp; visitor scores</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Inference_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/inference_discrete_bn.ipynb (reference label)"><span>Inference in Discrete Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Monty_Hall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/monty_hall.ipynb (reference label)"><span>Monty Hall Problem</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_inference.ipynb (reference label)"><span>Causal Inference Examples</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb (reference label)"><span>Causal Games</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-1" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-1 (reference label)"><span>Example 1</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-2" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-2 (reference label)"><span>Example 2</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-3" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-3 (reference label)"><span>Example 3</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-4" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-4 (reference label)"><span>Example 4</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-5" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-5 (reference label)"><span>Example 5</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-6" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-6 (reference label)"><span>Example 6</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-7" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-7 (reference label)"><span>Example 7</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Simulating_Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/simulating_data.ipynb (reference label)"><span>Simulating Data From Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Extending_pgmpy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/extending_pgmpy.ipynb (reference label)"><span>Extending pgmpy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Functional_Bayesian_Network_Tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/functional_bayesian_network_tutorial.ipynb (reference label)"><span>Functional Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Junction_Tree_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/junction_tree_inference.ipynb (reference label)"><span>Junction Tree Exact Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_27" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorial.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_27" id="__nav_3_1_27_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_27_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_27">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="1.%20Introduction%20to%20Probabilistic%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/1. introduction to probabilistic graphical models.ipynb (reference label)"><span>Introduction to Probabilitic Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="2.%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/2. bayesian networks.ipynb (reference label)"><span>Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="3.%20Causal%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/3. causal bayesian networks.ipynb (reference label)"><span>Causal Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="4.%20Markov%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/4. markov models.ipynb (reference label)"><span>Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="5.%20Exact%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/5. exact inference in graphical models.ipynb (reference label)"><span>Exact Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="6.%20Approximate%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/6. approximate inference in graphical models.ipynb (reference label)"><span>Approximate Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="7.%20Parameterizing%20with%20Continuous%20Variables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/7. parameterizing with continuous variables.ipynb (reference label)"><span>Parameterizing with Continuous Variables</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="8.%20Sampling%20Algorithms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Parameter-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#parameter-learning (reference label)"><span>Parameter Learning</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameter Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#State-counts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#state-counts (reference label)"><span>State counts</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Maximum-Likelihood-Estimation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#maximum-likelihood-estimation (reference label)"><span>Maximum Likelihood Estimation</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Bayesian-Parameter-Estimation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#bayesian-parameter-estimation (reference label)"><span>Bayesian Parameter Estimation</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#structure-learning (reference label)"><span>Structure Learning</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Scoring-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#scoring-functions (reference label)"><span>Scoring functions</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Search-strategies" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#search-strategies (reference label)"><span>Search strategies</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Search strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Constraint-based-Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#constraint-based-structure-learning (reference label)"><span>Constraint-<wbr>based Structure Learning</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#(Conditional)-Independence-Tests" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#(conditional)-independence-tests (reference label)"><span><wbr>(Conditional) Independence Tests</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#DAG-(pattern)-construction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#dag-(pattern)-construction (reference label)"><span>DAG <wbr>(pattern) construction</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG (pattern) construction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Hybrid-Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#hybrid-structure-learning (reference label)"><span>Hybrid Structure Learning</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Conclusion" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#conclusion (reference label)"><span>Conclusion</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../citation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/citation.rst (reference label)"><span>Citation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../development.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/development.rst (reference label)"><span>Getting Involved</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Parameter-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#parameter-learning (reference label)"><span>Parameter Learning</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameter Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#State-counts" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#state-counts (reference label)"><span>State counts</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Maximum-Likelihood-Estimation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#maximum-likelihood-estimation (reference label)"><span>Maximum Likelihood Estimation</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Bayesian-Parameter-Estimation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#bayesian-parameter-estimation (reference label)"><span>Bayesian Parameter Estimation</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#structure-learning (reference label)"><span>Structure Learning</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Scoring-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#scoring-functions (reference label)"><span>Scoring functions</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Search-strategies" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#search-strategies (reference label)"><span>Search strategies</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Search strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Constraint-based-Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#constraint-based-structure-learning (reference label)"><span>Constraint-<wbr>based Structure Learning</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#(Conditional)-Independence-Tests" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#(conditional)-independence-tests (reference label)"><span><wbr>(Conditional) Independence Tests</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#DAG-(pattern)-construction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#dag-(pattern)-construction (reference label)"><span>DAG <wbr>(pattern) construction</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG (pattern) construction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Hybrid-Structure-Learning" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#hybrid-structure-learning (reference label)"><span>Hybrid Structure Learning</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Conclusion" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#conclusion (reference label)"><span>Conclusion</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
  
                  


<h1 id="Learning-Bayesian-Networks-from-Data">Learning Bayesian Networks from Data<a class="headerlink" href="#Learning-Bayesian-Networks-from-Data" title="Link to this heading"></a></h1>
<p>Previous notebooks showed how Bayesian networks economically encode a probability distribution over a set of variables, and how they can be used e.g. to predict variable states, or to generate new samples from the joint distribution. This section will be about obtaining a Bayesian network, given a set of sample data. Learning a Bayesian network can be split into two problems:</p>
<p><strong>Parameter learning:</strong> Given a set of data samples and a DAG that captures the dependencies between the variables, estimate the (conditional) probability distributions of the individual variables.</p>
<p><strong>Structure learning:</strong> Given a set of data samples, estimate a DAG that captures the dependencies between the variables.</p>
<p>This notebook aims to illustrate how parameter learning and structure learning can be done with pgmpy. Currently, the library supports:</p>
<ul class="simple">
<li><p>Parameter learning for <em>discrete</em> nodes:</p>
<ul>
<li><p>Maximum Likelihood Estimation</p></li>
<li><p>Bayesian Estimation</p></li>
</ul>
</li>
<li><p>Structure learning for <em>discrete</em>, <em>fully observed</em> networks:</p>
<ul>
<li><p>Score-based structure estimation (BIC/BDeu/K2 score; exhaustive search, hill climb/tabu search)</p></li>
<li><p>Constraint-based structure estimation (PC)</p></li>
<li><p>Hybrid structure estimation (MMHC)</p></li>
</ul>
</li>
</ul>
<h2 id="Parameter-Learning">Parameter Learning<a class="headerlink" href="#Parameter-Learning" title="Link to this heading"></a></h2>
<p>Suppose we have the following data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,],</span>
                          <span class="s1">&#39;tasty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">],</span>
                          <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
     fruit tasty   size
0   banana   yes  large
1    apple    no  large
2   banana   yes  large
3    apple   yes  small
4   banana   yes  large
5    apple   yes  large
6   banana   yes  large
7    apple   yes  small
8    apple   yes  large
9    apple   yes  large
10  banana   yes  large
11  banana    no  large
12   apple    no  small
13  banana    no  small
</pre></div></div>
</div>
<p>We know that the variables relate as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="s1">&#39;tasty&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;tasty&#39;</span><span class="p">)])</span>  <span class="c1"># fruit -&gt; tasty &lt;- size</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<p>Parameter learning is the task to estimate the values of the conditional probability distributions (CPDs), for the variables <code class="docutils literal notranslate"><span class="pre">fruit</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, and <code class="docutils literal notranslate"><span class="pre">tasty</span></code>.</p>
<h3 id="State-counts">State counts<a class="headerlink" href="#State-counts" title="Link to this heading"></a></h3>
<p>To make sense of the given data, we can start by counting how often each state of the variable occurs. If the variable is dependent on parents, the counts are done conditionally on the parents states, i.e. for seperately for each parent configuration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParameterEstimator</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pe</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;fruit&#39;</span><span class="p">))</span>  <span class="c1"># unconditional</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pe</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">))</span>  <span class="c1"># conditional on fruit and size</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

         fruit
apple       7
banana      7

 fruit apple       banana
size  large small  large small
tasty
no      1.0   1.0    1.0   1.0
yes     3.0   2.0    5.0   0.0
</pre></div></div>
</div>
<p>We can see, for example, that as many apples as bananas were observed and that <code class="docutils literal notranslate"><span class="pre">5</span></code> large bananas were tasty, while only <code class="docutils literal notranslate"><span class="pre">1</span></code> was not.</p>
<h3 id="Maximum-Likelihood-Estimation">Maximum Likelihood Estimation<a class="headerlink" href="#Maximum-Likelihood-Estimation" title="Link to this heading"></a></h3>
<p>A natural estimate for the CPDs is to simply use the <em>relative frequencies</em>, with which the variable states have occured. We observed <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">apples</span></code> among a total of <code class="docutils literal notranslate"><span class="pre">14</span> <span class="pre">fruits</span></code>, so we might guess that about <code class="docutils literal notranslate"><span class="pre">50%</span></code> of <code class="docutils literal notranslate"><span class="pre">fruits</span></code> are <code class="docutils literal notranslate"><span class="pre">apples</span></code>.</p>
<p>This approach is <em>Maximum Likelihood Estimation (MLE)</em>. According to MLE, we should fill the CPDs in such a way, that <span class="math notranslate nohighlight">\(P(\text{data}|\text{model})\)</span> is maximal. This is achieved when using the <em>relative frequencies</em>. See [1], section 17.1 for an introduction to ML parameter estimation. pgmpy supports MLE as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="n">mle</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;fruit&#39;</span><span class="p">))</span>  <span class="c1"># unconditional</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">))</span>  <span class="c1"># conditional</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+---------------+-----+
| fruit(apple)  | 0.5 |
+---------------+-----+
| fruit(banana) | 0.5 |
+---------------+-----+
+------------+--------------+-----+---------------+
| fruit      | fruit(apple) | ... | fruit(banana) |
+------------+--------------+-----+---------------+
| size       | size(large)  | ... | size(small)   |
+------------+--------------+-----+---------------+
| tasty(no)  | 0.25         | ... | 1.0           |
+------------+--------------+-----+---------------+
| tasty(yes) | 0.75         | ... | 0.0           |
+------------+--------------+-----+---------------+
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mle.estimate_cpd(variable)</span></code> computes the state counts and divides each cell by the (conditional) sample size. The <code class="docutils literal notranslate"><span class="pre">mle.get_parameters()</span></code>-method returns a list of CPDs for all variable of the model.</p>
<p>The built-in <code class="docutils literal notranslate"><span class="pre">fit()</span></code>-method of <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code> provides more convenient access to parameter estimators:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Calibrate all CPDs of `model` using MLE:</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">MaximumLikelihoodEstimator</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>While very straightforward, the ML estimator has the problem of <em>overfitting</em> to the data. In above CPD, the probability of a large banana being tasty is estimated at <code class="docutils literal notranslate"><span class="pre">0.833</span></code>, because <code class="docutils literal notranslate"><span class="pre">5</span></code> out of <code class="docutils literal notranslate"><span class="pre">6</span></code> observed large bananas were tasty. Fine. But note that the probability of a small banana being tasty is estimated at <code class="docutils literal notranslate"><span class="pre">0.0</span></code>, because we observed only one small banana and it happened to be not tasty. But that should hardly make us certain that small bananas arent tasty! We simply do not have
enough observations to rely on the observed frequencies. If the observed data is not representative for the underlying distribution, ML estimations will be extremly far off.</p>
<p>When estimating parameters for Bayesian networks, lack of data is a frequent problem. Even if the total sample size is very large, the fact that state counts are done conditionally for each parents configuration causes immense fragmentation. If a variable has 3 parents that can each take 10 states, then state counts will be done seperately for <code class="docutils literal notranslate"><span class="pre">10^3</span> <span class="pre">=</span> <span class="pre">1000</span></code> parents configurations. This makes MLE very fragile and unstable for learning Bayesian Network parameters. A way to mitigate MLEs
overfitting is <em>Bayesian Parameter Estimation</em>.</p>
<h3 id="Bayesian-Parameter-Estimation">Bayesian Parameter Estimation<a class="headerlink" href="#Bayesian-Parameter-Estimation" title="Link to this heading"></a></h3>
<p>The Bayesian Parameter Estimator starts with already existing prior CPDs, that express our beliefs about the variables <em>before</em> the data was observed. Those priors are then updated, using the state counts from the observed data. See [1], Section 17.3 for a general introduction to Bayesian estimators.</p>
<p>One can think of the priors as consisting in <em>pseudo state counts</em>, that are added to the actual counts before normalization. Unless one wants to encode specific beliefs about the distributions of the variables, one commonly chooses uniform priors, i.e. ones that deem all states equiprobable.</p>
<p>A very simple prior is the so-called <em>K2</em> prior, which simply adds <code class="docutils literal notranslate"><span class="pre">1</span></code> to the count of every single state. A somewhat more sensible choice of prior is <em>BDeu</em> (Bayesian Dirichlet equivalent uniform prior). For BDeu we need to specify an <em>equivalent sample size</em> <code class="docutils literal notranslate"><span class="pre">N</span></code> and then the pseudo-counts are the equivalent of having observed <code class="docutils literal notranslate"><span class="pre">N</span></code> uniform samples of each variable (and each parent configuration). In pgmpy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="n">est</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s1">&#39;BDeu&#39;</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+------------+---------------------+-----+---------------------+
| fruit      | fruit(apple)        | ... | fruit(banana)       |
+------------+---------------------+-----+---------------------+
| size       | size(large)         | ... | size(small)         |
+------------+---------------------+-----+---------------------+
| tasty(no)  | 0.34615384615384615 | ... | 0.6428571428571429  |
+------------+---------------------+-----+---------------------+
| tasty(yes) | 0.6538461538461539  | ... | 0.35714285714285715 |
+------------+---------------------+-----+---------------------+
</pre></div></div>
</div>
<p>The estimated values in the CPDs are now more conservative. In particular, the estimate for a small banana being not tasty is now around <code class="docutils literal notranslate"><span class="pre">0.64</span></code> rather than <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. Setting <code class="docutils literal notranslate"><span class="pre">equivalent_sample_size</span></code> to <code class="docutils literal notranslate"><span class="pre">10</span></code> means that for each parent configuration, we add the equivalent of 10 uniform samples (here: <code class="docutils literal notranslate"><span class="pre">+5</span></code> small bananas that are tasty and <code class="docutils literal notranslate"><span class="pre">+5</span></code> that arent).</p>
<p><code class="docutils literal notranslate"><span class="pre">BayesianEstimator</span></code>, too, can be used via the <code class="docutils literal notranslate"><span class="pre">fit()</span></code>-method. Full example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianEstimator</span>

<span class="c1"># generate data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">BayesianEstimator</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;BDeu&quot;</span><span class="p">)</span> <span class="c1"># default equivalent_sample_size=5</span>
<span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cpd</span><span class="p">)</span>
</code><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+------+----------+
| A(0) | 0.511788 |
+------+----------+
| A(1) | 0.488212 |
+------+----------+
+------+---------------------+---------------------+
| A    | A(0)                | A(1)                |
+------+---------------------+---------------------+
| B(0) | 0.49199687682998244 | 0.5002046245140168  |
+------+---------------------+---------------------+
| B(1) | 0.5080031231700176  | 0.49979537548598324 |
+------+---------------------+---------------------+
+------+--------------------+-----+---------------------+
| A    | A(0)               | ... | A(1)                |
+------+--------------------+-----+---------------------+
| D    | D(0)               | ... | D(1)                |
+------+--------------------+-----+---------------------+
| C(0) | 0.4882005899705015 | ... | 0.5085907138474126  |
+------+--------------------+-----+---------------------+
| C(1) | 0.5117994100294986 | ... | 0.49140928615258744 |
+------+--------------------+-----+---------------------+
+------+--------------------+---------------------+
| B    | B(0)               | B(1)                |
+------+--------------------+---------------------+
| D(0) | 0.5120845921450151 | 0.48414271555996036 |
+------+--------------------+---------------------+
| D(1) | 0.4879154078549849 | 0.5158572844400396  |
+------+--------------------+---------------------+
</pre></div></div>
</div>
<h2 id="Structure-Learning">Structure Learning<a class="headerlink" href="#Structure-Learning" title="Link to this heading"></a></h2>
<p>To learn model structure (a DAG) from a data set, there are two broad techniques:</p>
<ul class="simple">
<li><p>score-based structure learning</p></li>
<li><p>constraint-based structure learning</p></li>
</ul>
<p>The combination of both techniques allows further improvement:</p>
<ul class="simple">
<li><p>hybrid structure learning</p></li>
</ul>
<p>We briefly discuss all approaches and give examples.</p>
<p>This approach construes model selection as an optimization task. It has two building blocks:</p>
<ul class="simple">
<li><p>A <em>scoring function</em> <span class="math notranslate nohighlight">\(s_D\colon M \to \mathbb R\)</span> that maps models to a numerical score, based on how well they fit to a given data set <span class="math notranslate nohighlight">\(D\)</span>.</p></li>
<li><p>A <em>search strategy</em> to traverse the search space of possible models <span class="math notranslate nohighlight">\(M\)</span> and select a model with optimal score.</p></li>
</ul>
<h3 id="Scoring-functions">Scoring functions<a class="headerlink" href="#Scoring-functions" title="Link to this heading"></a></h3>
<p>Commonly used scores to measure the fit between model and data are <em>Bayesian Dirichlet scores</em> such as <em>BDeu</em> or <em>K2</em> and the <em>Bayesian Information Criterion</em> (BIC, also called MDL). See [1], Section 18.3 for a detailed introduction on scores. As before, BDeu is dependent on an equivalent sample size.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BDeuScore</span><span class="p">,</span> <span class="n">K2Score</span><span class="p">,</span> <span class="n">BicScore</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="c1"># create random data sample with 3 variables, where Z is dependent on X, Y:</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;XY&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>

<span class="n">bdeu</span> <span class="o">=</span> <span class="n">BDeuScore</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">bic</span> <span class="o">=</span> <span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">model1</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)])</span>  <span class="c1"># X -&gt; Z &lt;- Y</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)])</span>  <span class="c1"># Y &lt;- X -&gt; Z</span>


<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
</code><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-13938.353002020234
-14329.194269073454
-14294.390420213556
-20906.432489257266
-20933.26023936978
-20950.47339067585
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<p>While the scores vary slightly, we can see that the correct <code class="docutils literal notranslate"><span class="pre">model1</span></code> has a much higher score than <code class="docutils literal notranslate"><span class="pre">model2</span></code>. Importantly, these scores <em>decompose</em>, i.e. they can be computed locally for each of the variables given their potential parents, independent of other parts of the network:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-9282.88160824462
-6993.603560250576
-57.1217389219957
</pre></div></div>
</div>
<h3 id="Search-strategies">Search strategies<a class="headerlink" href="#Search-strategies" title="Link to this heading"></a></h3>
<p>The search space of DAGs is super-exponential in the number of variables and the above scoring functions allow for local maxima. The first property makes exhaustive search intractable for all but very small networks, the second prohibits efficient local optimization algorithms to always find the optimal structure. Thus, identifiying the ideal structure is often not tractable. Despite these bad news, heuristic search strategies often yields good results.</p>
<p>If only few nodes are involved (read: less than 5), <code class="docutils literal notranslate"><span class="pre">ExhaustiveSearch</span></code> can be used to compute the score for every DAG and returns the best-scoring one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExhaustiveSearch</span>

<span class="n">es</span> <span class="o">=</span> <span class="n">ExhaustiveSearch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="n">bic</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">All DAGs by score:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">dag</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">es</span><span class="o">.</span><span class="n">all_scores</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">dag</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]

All DAGs by score:
-14294.390420213556 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-14330.086974085189 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-14330.086974085189 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-14330.08697408519 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-16586.926723773093 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-16587.66791728165 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-18657.937087116316 [(&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-18657.937087116316 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-18657.937087116316 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-20914.776836804216 [(&#39;Z&#39;, &#39;X&#39;)]
-20914.776836804216 [(&#39;X&#39;, &#39;Z&#39;)]
-20915.518030312778 [(&#39;Z&#39;, &#39;Y&#39;)]
-20915.518030312778 [(&#39;Y&#39;, &#39;Z&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;)]
-20951.21458418441 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-20951.21458418441 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-20951.21458418441 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-23172.357780000675 []
-23208.05433387231 [(&#39;Y&#39;, &#39;X&#39;)]
-23208.05433387231 [(&#39;X&#39;, &#39;Y&#39;)]
</pre></div></div>
</div>
<p>Once more nodes are involved, one needs to switch to heuristic search. <code class="docutils literal notranslate"><span class="pre">HillClimbSearch</span></code> implements a greedy local search that starts from the DAG <code class="docutils literal notranslate"><span class="pre">start</span></code> (default: disconnected DAG) and proceeds by iteratively performing single-edge manipulations that maximally increase the score. The search terminates once a local maximum is found.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">HillClimbSearch</span>

<span class="c1"># create some data with dependencies</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="n">hc</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1f781a2436e4066ab8e015257068eb8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;A&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<p>The search correctly identifies e.g. that <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> do not influnce <code class="docutils literal notranslate"><span class="pre">H</span></code> directly, only through <code class="docutils literal notranslate"><span class="pre">A</span></code> and of course that <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">E</span></code>, <code class="docutils literal notranslate"><span class="pre">F</span></code> are independent.</p>
<p>To enforce a wider exploration of the search space, the search can be enhanced with a tabu list. The list keeps track of the last <code class="docutils literal notranslate"><span class="pre">n</span></code> modfications; those are then not allowed to be reversed, regardless of the score. Additionally a <code class="docutils literal notranslate"><span class="pre">white_list</span></code> or <code class="docutils literal notranslate"><span class="pre">black_list</span></code> can be supplied to restrict the search to a particular subset or to exclude certain edges. The parameter <code class="docutils literal notranslate"><span class="pre">max_indegree</span></code> allows to restrict the maximum number of parents for each node.</p>
<h4 id="Constraint-based-Structure-Learning">Constraint-based Structure Learning<a class="headerlink" href="#Constraint-based-Structure-Learning" title="Link to this heading"></a></h4>
<p>A different, but quite straightforward approach to build a DAG from data is this:</p>
<ol class="arabic simple">
<li><p>Identify independencies in the data set using hypothesis tests</p></li>
<li><p>Construct DAG (pattern) according to identified independencies</p></li>
</ol>
<h3 id="(Conditional)-Independence-Tests">(Conditional) Independence Tests<a class="headerlink" href="#(Conditional)-Independence-Tests" title="Link to this heading"></a></h3>
<p>Independencies in the data can be identified using chi2 conditional independence tests. To this end, a conditional independence hypothesis test is performed to check if <code class="docutils literal notranslate"><span class="pre">X</span></code> is independent from <code class="docutils literal notranslate"><span class="pre">Y</span></code> given a set of variables <code class="docutils literal notranslate"><span class="pre">Zs</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">PC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators.CITests</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi_square</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># dependent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>       <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>       <span class="c1"># dependent</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
True
True
True
False
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CITests.py</span></code> module in pgmpy implements a few possible conditional independence tests.</p>
<h3 id="DAG-(pattern)-construction">DAG (pattern) construction<a class="headerlink" href="#DAG-(pattern)-construction" title="Link to this heading"></a></h3>
<p>With a method for independence testing at hand, we can construct a DAG from the data set in three steps:</p>
<ol class="arabic simple">
<li><p>Construct an undirected skeleton - <code class="docutils literal notranslate"><span class="pre">estimate_skeleton()</span></code></p></li>
<li><p>Orient compelled edges to obtain partially directed acyclid graph (PDAG; I-equivalence class of DAGs) - <code class="docutils literal notranslate"><span class="pre">skeleton_to_pdag()</span></code></p></li>
<li><p>Extend DAG pattern to a DAG by conservatively orienting the remaining edges in some way - <code class="docutils literal notranslate"><span class="pre">pdag_to_dag()</span></code></p></li>
</ol>
<p>Step 1.&amp;2. form the so-called PC algorithm, see [2], page 550. PDAGs are <code class="docutils literal notranslate"><span class="pre">DirectedGraph</span></code>s, that may contain both-way edges, to indicate that the orientation for the edge is not determined.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">est</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">skel</span><span class="p">,</span> <span class="n">seperating_sets</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">significance_level</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Undirected edges: &quot;</span><span class="p">,</span> <span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="n">pdag</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="n">skel</span><span class="p">,</span> <span class="n">seperating_sets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PDAG edges:       &quot;</span><span class="p">,</span> <span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">to_dag</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DAG edges:        &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a282f0a828a4d2a8fc995b9f57204ef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Undirected edges:  [(&#39;A&#39;, &#39;B&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;H&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;G&#39;, &#39;H&#39;)]
PDAG edges:        [(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;F&#39;, &#39;E&#39;)]
DAG edges:         [(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;)]
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">estimate()</span></code>-method provides a shorthand for the three steps above and directly returns a <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">significance_level</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ce622083c1f46fbba5a4f0444935739", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;)]
</pre></div></div>
</div>
<p>PC PDAG construction is only guaranteed to work under the assumption that the identified set of independencies is <em>faithful</em>, i.e. there exists a DAG that exactly corresponds to it. Spurious dependencies in the data set can cause the reported independencies to violate faithfulness. It can happen that the estimated PDAG does not have any faithful completions (i.e. edge orientations that do not introduce new v-structures). In that case a warning is issued.</p>
<h4 id="Hybrid-Structure-Learning">Hybrid Structure Learning<a class="headerlink" href="#Hybrid-Structure-Learning" title="Link to this heading"></a></h4>
<p>The MMHC algorithm [3] combines the constraint-based and score-based method. It has two parts:</p>
<ol class="arabic simple">
<li><p>Learn undirected graph skeleton using the constraint-based construction procedure MMPC</p></li>
<li><p>Orient edges using score-based optimization (BDeu score + modified hill-climbing)</p></li>
</ol>
<p>We can perform the two steps seperately, more or less as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">MmhcEstimator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BDeuScore</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>

<span class="n">mmhc</span> <span class="o">=</span> <span class="n">MmhcEstimator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">skeleton</span> <span class="o">=</span> <span class="n">mmhc</span><span class="o">.</span><span class="n">mmpc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1) Skeleton: &quot;</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="c1"># use hill climb search to orient the edges:</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">tabu_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">white_list</span><span class="o">=</span><span class="n">skeleton</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">(),</span> <span class="n">scoring_method</span><span class="o">=</span><span class="n">BDeuScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 2) Model:    &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part 1) Skeleton:  [(&#39;A&#39;, &#39;B&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;H&#39;), (&#39;A&#39;, &#39;E&#39;), (&#39;A&#39;, &#39;G&#39;), (&#39;B&#39;, &#39;E&#39;), (&#39;C&#39;, &#39;G&#39;), (&#39;C&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;F&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;E&#39;, &#39;H&#39;), (&#39;F&#39;, &#39;G&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "29a61574918e4004a7d1b7a76a3b3b2d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part 2) Model:     [(&#39;A&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;F&#39;, &#39;E&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MmhcEstimator.estimate()</span></code> is a shorthand for both steps and directly estimates a <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code>.</p>
<h4 id="Conclusion">Conclusion<a class="headerlink" href="#Conclusion" title="Link to this heading"></a></h4>
<p>This notebook aimed to give an overview of pgmpys estimators for learning Bayesian network structure and parameters. For more information about the individual functions see their docstring documentation. If you used pgmpys structure learning features to satisfactorily learn a non-trivial network from real data, feel free to drop us an eMail via the mailing list or just open a Github issue. Wed like to put your network in the examples-section!</p>
<h4 id="References">References<a class="headerlink" href="#References" title="Link to this heading"></a></h4>
<p>[1] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</p>
<p>[2] Neapolitan, <a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">Learning Bayesian Networks</a>, 2003</p>
<p>[3] Tsamardinos et al., <a class="reference external" href="http://www.dsl-lab.org/supplements/mmhc_paper/paper_online.pdf">The max-min hill-climbing BN structure learning algorithm</a>, 2005</p>







  
  






                
  <div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="stickybox"></div>
  <script>
    (function() {
      var nav = document.querySelector('.md-header__inner');
      if (!nav) return;

      var socialDiv = document.createElement('div');
      socialDiv.className = 'md-header__social';

      socialDiv.innerHTML =
        '<a href="https://github.com/pgmpy/pgmpy" target="_blank" rel="noopener" title="GitHub">' +
          '<svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.8-14.9-112.8-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://discord.gg/DRkdKaumBs" target="_blank" rel="noopener" title="Discord">' +
          '<svg viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91A483.689 483.689 0 0 0 116.085 69.137a1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375A487.666 487.666 0 0 0 176.02 479.918a1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665 0 53.306 26.82 52.843 59.239C275.334 310.993 251.924 337.58 222.491 337.58zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667 0 53.307 26.82 52.844 59.239C470.715 310.993 447.538 337.58 417.871 337.58z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://www.linkedin.com/company/pgmpy/" target="_blank" rel="noopener" title="LinkedIn">' +
          '<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/>' +
          '</svg>' +
        '</a>';

      nav.appendChild(socialDiv);
    })();
  </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, Ankur Ankan.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    9.1.0.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "1.0.0 (stable)", "version": "https://pgmpy.org"}, {"aliases": [], "title": "dev", "version": "https://pgmpy.org/dev"}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>
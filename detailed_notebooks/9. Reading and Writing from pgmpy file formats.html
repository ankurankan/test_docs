


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="8.%20Sampling%20Algorithms.html">
      
      
        <link rel="next" href="10.%20Learning%20Bayesian%20Networks%20from%20Data.html">
      
      
      <link rel="icon" href="../_static/logo_favi.ico">
    
    
      
        <title>Reading and Writing from pgmpy file formats - pgmpy</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  <!-- SEO meta tags -->
  <meta name="description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="keywords" content="pgmpy, Bayesian Networks, causal inference, probabilistic graphical models, structure learning, parameter estimation, Python">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="pgmpy">
  <meta property="og:title" content="Reading and Writing from pgmpy file formats">
  <meta property="og:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta property="og:url" content="https://pgmpy.org/detailed_notebooks/9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html">
  <meta property="og:image" content="https://pgmpy.org/_static/logo.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Reading and Writing from pgmpy file formats">
  <meta name="twitter:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="twitter:image" content="https://pgmpy.org/_static/logo.png">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HCFR07M31W');
  </script>
  <!-- EthicalAds -->
  <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
  <!-- Header social links styling -->
  <style>
    .md-header__social {
      display: flex;
      align-items: center;
      gap: 0.1rem;
      margin-left: 0.4rem;
    }
    .md-header__social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem;
      color: var(--md-default-fg-color--light);
      opacity: 0.7;
      transition: opacity 0.25s;
    }
    .md-header__social a:hover {
      opacity: 1;
    }
    .md-header__social svg {
      width: 1.2rem;
      height: 1.2rem;
      fill: currentColor;
    }
    [data-md-color-scheme="slate"] .md-header__social a {
      color: var(--md-default-fg-color--light);
    }
    /* Hover shadow effect on feature cards */
    .sd-card-hover {
      transition: box-shadow 0.25s ease, transform 0.25s ease;
    }
    .sd-card-hover:hover {
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
      transform: translateY(-2px);
    }
    /* Center content when right sidebar (toc) is hidden */
    .md-sidebar--secondary[hidden] ~ .md-content {
      margin-left: auto;
      margin-right: auto;
    }
  </style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#General-WorkFlow-of-the-readwrite-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="pgmpy" class="md-header__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pgmpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reading and Writing from pgmpy file formats
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../started/base.html" class="md-tabs__link">
        
  
    
  
  <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../documentation.html" class="md-tabs__link">
        
  
    
  
  <span title="/documentation.rst (reference label)"><span>Documentation</span></span>

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../examples.html" class="md-tabs__link">
        
  
    
  
  <span title="/examples.rst (reference label)"><span>Examples</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api.html" class="md-tabs__link">
        
  
    
  
  <span title="/api.rst (reference label)"><span>API Reference</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development.html" class="md-tabs__link">
        
  
    
  
  <span title="/development.rst (reference label)"><span>Development</span></span>

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="pgmpy" class="md-nav__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    pgmpy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../started/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/documentation.rst (reference label)"><span>Documentation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#defining-bayesian-networks" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst#defining-bayesian-networks (reference label)"><span>Defining Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#causal-discovery-structure-learning" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="causal discovery / structure learning (reference label)"><span>Causal Discovery / Structure Learning</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#parameter-estimation" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="parameter estimation (reference label)"><span>Parameter Estimation</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#probabilistic-inference" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="probabilistic inference (reference label)"><span>Probabilistic Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#causal-inference" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst#causal-inference (reference label)"><span>Causal Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html#simulations" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst#simulations (reference label)"><span>Simulations</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html#extending-pgmpy" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="extending pgmpy (reference label)"><span>Extending pgmpy</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            <span title="extending pgmpy (reference label)"><span>Extending pgmpy</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Extending_pgmpy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/extending_pgmpy.ipynb (reference label)"><span>Extending pgmpy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Functional_Bayesian_Network_Tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/functional_bayesian_network_tutorial.ipynb (reference label)"><span>Functional Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Junction_Tree_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/junction_tree_inference.ipynb (reference label)"><span>Junction Tree Exact Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorial.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_4" id="__nav_3_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7_4">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="1.%20Introduction%20to%20Probabilistic%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/1. introduction to probabilistic graphical models.ipynb (reference label)"><span>Introduction to Probabilitic Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="2.%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/2. bayesian networks.ipynb (reference label)"><span>Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="3.%20Causal%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/3. causal bayesian networks.ipynb (reference label)"><span>Causal Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="4.%20Markov%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/4. markov models.ipynb (reference label)"><span>Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="5.%20Exact%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/5. exact inference in graphical models.ipynb (reference label)"><span>Exact Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="6.%20Approximate%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/6. approximate inference in graphical models.ipynb (reference label)"><span>Approximate Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="7.%20Parameterizing%20with%20Continuous%20Variables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/7. parameterizing with continuous variables.ipynb (reference label)"><span>Parameterizing with Continuous Variables</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="8.%20Sampling%20Algorithms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#General-WorkFlow-of-the-readwrite-module" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb#general-workflow-of-the-readwrite-module (reference label)"><span>General Work<wbr>Flow of the readwrite module</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="10.%20Learning%20Bayesian%20Networks%20from%20Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../development.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/development.rst (reference label)"><span>Development</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#General-WorkFlow-of-the-readwrite-module" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb#general-workflow-of-the-readwrite-module (reference label)"><span>General Work<wbr>Flow of the readwrite module</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
  
                  


<h1 id="Reading-and-Writing-from-pgmpy-file-formats">Reading and Writing from pgmpy file formats<a class="headerlink" href="#Reading-and-Writing-from-pgmpy-file-formats" title="Link to this heading">¶</a></h1>
<p>pgmpy is a python library for creation, manipulation and implementation of Probabilistic graph models. There are various standard file formats for representing PGM data. PGM data basically consists of graph, a distribution assoicated to each node and a few other attributes of a graph.</p>
<p>pgmpy has a functionality to read networks from and write networks to these standard file formats. Currently pgmpy supports 5 file formats ProbModelXML, PomDPX, XMLBIF, XMLBeliefNetwork and UAI file formats. Using these modules, models can be specified in a uniform file format and readily converted to bayesian or markov model objects.</p>
<p>Now, Let’s read a ProbModel XML File and get the corresponding model instance of the probmodel.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[55]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.readwrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProbModelXMLReader</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[56]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">reader_string</span> <span class="o">=</span> <span class="n">ProbModelXMLReader</span><span class="p">(</span><span class="s1">&#39;../files/example.pgmx&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>Now to get the corresponding model instance we need <code class="docutils literal notranslate"><span class="pre">get_model</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[57]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">reader_string</span><span class="o">.</span><span class="n">get_model</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>Now we can query this model accoring to our requirements. It is an instance of BayesianModel or MarkovModel depending on the type of the model which is given.</p>
<p>Suppose we want to know all the nodes in the given model, we can do:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[58]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;X-ray&#39;, &#39;Bronchitis&#39;, &#39;Dyspnea&#39;, &#39;VisitToAsia&#39;, &#39;Smoker&#39;, &#39;LungCancer&#39;, &#39;Tuberculosis&#39;, &#39;TuberculosisOrCancer&#39;]
</pre></div></div>
</div>
<p>To get all the edges we can use <code class="docutils literal notranslate"><span class="pre">model.edges</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[59]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[59]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OutEdgeView([(&#39;Bronchitis&#39;, &#39;Dyspnea&#39;), (&#39;VisitToAsia&#39;, &#39;Tuberculosis&#39;), (&#39;Smoker&#39;, &#39;Bronchitis&#39;), (&#39;Smoker&#39;, &#39;LungCancer&#39;), (&#39;LungCancer&#39;, &#39;TuberculosisOrCancer&#39;), (&#39;Tuberculosis&#39;, &#39;TuberculosisOrCancer&#39;), (&#39;TuberculosisOrCancer&#39;, &#39;Dyspnea&#39;), (&#39;TuberculosisOrCancer&#39;, &#39;X-ray&#39;)])
</pre></div></div>
</div>
<p>To get all the cpds of the given model we can use <code class="docutils literal notranslate"><span class="pre">model.get_cpds</span></code> and to get the corresponding values we can iterate over each cpd and call the corresponding <code class="docutils literal notranslate"><span class="pre">get_cpd</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[60]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cpds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">()</span>
<span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">cpds</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cpd</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+----------------------+-------------------------+-------------------------+
| TuberculosisOrCancer | TuberculosisOrCancer(0) | TuberculosisOrCancer(1) |
+----------------------+-------------------------+-------------------------+
| X-ray(0)             | 0.95                    | 0.05                    |
+----------------------+-------------------------+-------------------------+
| X-ray(1)             | 0.02                    | 0.98                    |
+----------------------+-------------------------+-------------------------+
+---------------+-----------+-----------+
| Smoker        | Smoker(0) | Smoker(1) |
+---------------+-----------+-----------+
| Bronchitis(0) | 0.7       | 0.3       |
+---------------+-----------+-----------+
| Bronchitis(1) | 0.4       | 0.6       |
+---------------+-----------+-----------+
+----------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| TuberculosisOrCancer | TuberculosisOrCancer(0) | TuberculosisOrCancer(0) | TuberculosisOrCancer(1) | TuberculosisOrCancer(1) |
+----------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| Bronchitis           | Bronchitis(0)           | Bronchitis(1)           | Bronchitis(0)           | Bronchitis(1)           |
+----------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| Dyspnea(0)           | 0.9                     | 0.1                     | 0.3                     | 0.7                     |
+----------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| Dyspnea(1)           | 0.2                     | 0.8                     | 0.1                     | 0.9                     |
+----------------------+-------------------------+-------------------------+-------------------------+-------------------------+
+----------------+------+
| VisitToAsia(0) | 0.99 |
+----------------+------+
| VisitToAsia(1) | 0.01 |
+----------------+------+
+-----------+-----+
| Smoker(0) | 0.5 |
+-----------+-----+
| Smoker(1) | 0.5 |
+-----------+-----+
+---------------+-----------+-----------+
| Smoker        | Smoker(0) | Smoker(1) |
+---------------+-----------+-----------+
| LungCancer(0) | 0.99      | 0.01      |
+---------------+-----------+-----------+
| LungCancer(1) | 0.9       | 0.1       |
+---------------+-----------+-----------+
+-----------------+----------------+----------------+
| VisitToAsia     | VisitToAsia(0) | VisitToAsia(1) |
+-----------------+----------------+----------------+
| Tuberculosis(0) | 0.99           | 0.01           |
+-----------------+----------------+----------------+
| Tuberculosis(1) | 0.95           | 0.05           |
+-----------------+----------------+----------------+
+-------------------------+-----------------+-----------------+-----------------+-----------------+
| LungCancer              | LungCancer(0)   | LungCancer(0)   | LungCancer(1)   | LungCancer(1)   |
+-------------------------+-----------------+-----------------+-----------------+-----------------+
| Tuberculosis            | Tuberculosis(0) | Tuberculosis(1) | Tuberculosis(0) | Tuberculosis(1) |
+-------------------------+-----------------+-----------------+-----------------+-----------------+
| TuberculosisOrCancer(0) | 1.0             | 0.0             | 0.0             | 1.0             |
+-------------------------+-----------------+-----------------+-----------------+-----------------+
| TuberculosisOrCancer(1) | 0.0             | 1.0             | 0.0             | 1.0             |
+-------------------------+-----------------+-----------------+-----------------+-----------------+
</pre></div></div>
</div>
<p>pgmpy not only allows us to read from the specific file format but also helps us to write the given model into the specific file format. Let’s write a sample model into Probmodel XML file.</p>
<p>For that first define our data for the model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[61]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">edges_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;VisitToAsia&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuberculosis&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;LungCancer&#39;</span><span class="p">,</span> <span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;Smoker&#39;</span><span class="p">,</span> <span class="s1">&#39;LungCancer&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;Smoker&#39;</span><span class="p">,</span> <span class="s1">&#39;Bronchitis&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;Tuberculosis&#39;</span><span class="p">,</span> <span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;Bronchitis&#39;</span><span class="p">,</span> <span class="s1">&#39;Dyspnea&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">,</span> <span class="s1">&#39;Dyspnea&#39;</span><span class="p">),</span>
              <span class="p">(</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">,</span> <span class="s1">&#39;X-ray&#39;</span><span class="p">)]</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Smoker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                    <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;52&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;568&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Bronchitis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                        <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;181&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;698&#39;</span><span class="p">},</span>
                        <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;VisitToAsia&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                         <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;58&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;290&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Tuberculosis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                          <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;150&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;201&#39;</span><span class="p">},</span>
                          <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;X-ray&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                   <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">},</span>
                   <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;322&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;252&#39;</span><span class="p">},</span>
                   <span class="s1">&#39;Comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indica si el test de rayos X ha sido positivo&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">},</span>
         <span class="s1">&#39;Dyspnea&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                     <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;321&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;533&#39;</span><span class="p">},</span>
                     <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                                  <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;238&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;336&#39;</span><span class="p">},</span>
                                  <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;LungCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;States&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="p">{}},</span>
                        <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;chance&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;finiteStates&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Coordinates&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;152&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;421&#39;</span><span class="p">},</span>
                        <span class="s1">&#39;AdditionalProperties&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevance&#39;</span><span class="p">:</span> <span class="s1">&#39;7.0&#39;</span><span class="p">}}}</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LungCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Smoker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;LungCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;Bronchitis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Dyspnea&#39;</span><span class="p">:</span> <span class="p">{},</span>
         <span class="s1">&#39;X-ray&#39;</span><span class="p">:</span> <span class="p">{},</span>
         <span class="s1">&#39;VisitToAsia&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Tuberculosis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X-ray&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">},</span>
                                  <span class="s1">&#39;Dyspnea&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Bronchitis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Dyspnea&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}},</span>
         <span class="s1">&#39;Tuberculosis&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}}}</span>

<span class="n">cpds</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X-ray&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Bronchitis&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Smoker&#39;</span><span class="p">]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">,</span>  <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.9</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Dyspnea&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">,</span> <span class="s1">&#39;Bronchitis&#39;</span><span class="p">]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.99</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;VisitToAsia&#39;</span><span class="p">:</span> <span class="p">[]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Smoker&#39;</span><span class="p">:</span> <span class="p">[]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;LungCancer&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Smoker&#39;</span><span class="p">]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Tuberculosis&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VisitToAsia&#39;</span><span class="p">]}},</span>
        <span class="p">{</span><span class="s1">&#39;Values&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]),</span>
         <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TuberculosisOrCancer&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;LungCancer&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuberculosis&#39;</span><span class="p">]}}]</span>
</code></pre></div>
</div>
</div>
<p>Now let’s create a <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code> for this data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[62]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.factors.discrete</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularCPD</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">(</span><span class="n">edges_list</span><span class="p">)</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">edges</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1">#import pdb; pdb.set_trace()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">[(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<span class="n">tabular_cpds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">cpds</span><span class="p">:</span>
    <span class="n">var</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cpd</span><span class="p">[</span><span class="s1">&#39;Variables&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="n">cpd</span><span class="p">[</span><span class="s1">&#39;Variables&#39;</span><span class="p">][</span><span class="n">var</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">cpd</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">]</span>
    <span class="n">states</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">])</span>
    <span class="n">evidence_card</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">evidence_var</span><span class="p">][</span><span class="s1">&#39;States&#39;</span><span class="p">])</span>
                     <span class="k">for</span> <span class="n">evidence_var</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">]</span>
    <span class="n">tabular_cpds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">TabularCPD</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">evidence_card</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="o">*</span><span class="n">tabular_cpds</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[63]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.readwrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProbModelXMLWriter</span><span class="p">,</span> <span class="n">get_probmodel_data</span>
</code></pre></div>
</div>
</div>
<p>To get the data which we need to give to the ProbModelXMLWriter to get the corresponding fileformat we need to use the method get_probmodel_data. This method is only specific to ProbModelXML file, for other file formats we would directly pass the model to the given Writer Class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[64]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">model_data</span> <span class="o">=</span> <span class="n">get_probmodel_data</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">ProbModelXMLWriter</span><span class="p">(</span><span class="n">model_data</span><span class="o">=</span><span class="n">model_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">writer</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;ProbModelXML formatVersion=&#34;1.0&#34;&gt;
  &lt;ProbNet type=&#34;BayesianNetwork&#34;&gt;
    &lt;Variables&gt;
      &lt;Variable name=&#34;Bronchitis&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;698&#34; y=&#34;181&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;B&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;Dyspnea&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;533&#34; y=&#34;321&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;D&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;LungCancer&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;421&#34; y=&#34;152&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;L&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;Smoker&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;568&#34; y=&#34;52&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;S&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;Tuberculosis&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;201&#34; y=&#34;150&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;T&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;TuberculosisOrCancer&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;336&#34; y=&#34;238&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;E&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;VisitToAsia&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Coordinates x=&#34;290&#34; y=&#34;58&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;A&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
      &lt;Variable name=&#34;X-ray&#34; role=&#34;chance&#34; type=&#34;finiteStates&#34;&gt;
        &lt;Comment&gt;Indica si el test de rayos X ha sido positivo&lt;/Comment&gt;
        &lt;Coordinates x=&#34;252&#34; y=&#34;322&#34; /&gt;
        &lt;Property name=&#34;Relevance&#34; value=&#34;7.0&#34; /&gt;
        &lt;Property name=&#34;Title&#34; value=&#34;X&#34; /&gt;
        &lt;States&gt;
          &lt;State name=&#34;no&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
          &lt;State name=&#34;yes&#34;&gt;
            &lt;AdditionalProperties /&gt;
          &lt;/State&gt;
        &lt;/States&gt;
      &lt;/Variable&gt;
    &lt;/Variables&gt;
    &lt;Links&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;Bronchitis&#34; var2=&#34;Dyspnea&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;LungCancer&#34; var2=&#34;TuberculosisOrCancer&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;Smoker&#34; var2=&#34;Bronchitis&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;Smoker&#34; var2=&#34;LungCancer&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;Tuberculosis&#34; var2=&#34;TuberculosisOrCancer&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;TuberculosisOrCancer&#34; var2=&#34;Dyspnea&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;TuberculosisOrCancer&#34; var2=&#34;X-ray&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
      &lt;Link directed=&#34;true&#34; var1=&#34;VisitToAsia&#34; var2=&#34;Tuberculosis&#34;&gt;
        &lt;AdditionalProperties /&gt;
      &lt;/Link&gt;
    &lt;/Links&gt;
    &lt;Potentials&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;X-ray&#34; /&gt;
          &lt;Variable name=&#34;TuberculosisOrCancer&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.95 0.05 0.02 0.98 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;Bronchitis&#34; /&gt;
          &lt;Variable name=&#34;Smoker&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.7 0.3 0.4 0.6 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;Dyspnea&#34; /&gt;
          &lt;Variable name=&#34;Bronchitis&#34; /&gt;
          &lt;Variable name=&#34;TuberculosisOrCancer&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.9 0.1 0.3 0.7 0.2 0.8 0.1 0.9 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;VisitToAsia&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.99 0.01 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;Smoker&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.5 0.5 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;LungCancer&#34; /&gt;
          &lt;Variable name=&#34;Smoker&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.99 0.01 0.9 0.1 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;Tuberculosis&#34; /&gt;
          &lt;Variable name=&#34;VisitToAsia&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;0.99 0.01 0.95 0.05 &lt;/Values&gt;
      &lt;/Potential&gt;
      &lt;Potential role=&#34;conditionalProbability&#34; type=&#34;Table&#34;&gt;
        &lt;Variables&gt;
          &lt;Variable name=&#34;TuberculosisOrCancer&#34; /&gt;
          &lt;Variable name=&#34;LungCancer&#34; /&gt;
          &lt;Variable name=&#34;Tuberculosis&#34; /&gt;
        &lt;/Variables&gt;
        &lt;Values&gt;1.0 0.0 0.0 1.0 0.0 1.0 0.0 1.0 &lt;/Values&gt;
      &lt;/Potential&gt;
    &lt;/Potentials&gt;
    &lt;AdditionalConstraints /&gt;
    &lt;AdditionalProperties /&gt;
    &lt;DecisionCriteria /&gt;
  &lt;/ProbNet&gt;
&lt;/ProbModelXML&gt;

</pre></div></div>
</div>
<p>To write the xml data into the file we can use the method <code class="docutils literal notranslate"><span class="pre">write_file</span></code> of the given Writer class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[65]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">writer</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="s1">&#39;probmodelxml.pgmx&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="General-WorkFlow-of-the-readwrite-module">General WorkFlow of the readwrite module<a class="headerlink" href="#General-WorkFlow-of-the-readwrite-module" title="Link to this heading">¶</a></h2>
<p>pgmpy.readwrite.[fileformat]Reader is base class for reading the given file format. Replace file format with the desired fileforamt from which you want to read the file. In this base class there are different methods defined to parse the given file. For example for XMLBelief Network various methods which are defined are as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[66]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.readwrite.XMLBeliefNetwork</span><span class="w"> </span><span class="kn">import</span> <span class="n">XBNReader</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">XBNReader</span><span class="p">(</span><span class="s1">&#39;../files/xmlbelief.xml&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">get_model</span></code>: It returns an instance of the given model, for ex, BayesianModel in cases of XMLBelief format.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[67]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_model</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]
[(&#39;a&#39;, &#39;b&#39;), (&#39;a&#39;, &#39;c&#39;), (&#39;b&#39;, &#39;d&#39;), (&#39;c&#39;, &#39;d&#39;), (&#39;c&#39;, &#39;e&#39;)]
</pre></div></div>
</div>
<p>pgmpy.readwrite.[fileformat]Writer is base class for writing the model into the given file format. It takes a model as an argument which can be an instance of BayesianModel, MarkovModel. Replace file fomat with the desired fileforamt from which you want to read the file. In this base class there are different methods defined to set the contents of the new file to be created from the given model. For example for XMLBelief Network various methods such as set_analysisnotebook, etc are defined which
helps to set up the network data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[53]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.factors.discrete</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;STATES&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Present&#39;</span><span class="p">,</span> <span class="s1">&#39;Absent&#39;</span><span class="p">],</span>
               <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span> <span class="s1">&#39;(c) Brain Tumor&#39;</span><span class="p">,</span>
               <span class="s1">&#39;YPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;11935&#39;</span><span class="p">,</span>
               <span class="s1">&#39;XPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;15250&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">},</span>
         <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;STATES&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Present&#39;</span><span class="p">,</span> <span class="s1">&#39;Absent&#39;</span><span class="p">],</span>
               <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span> <span class="s1">&#39;(a) Metastatic Cancer&#39;</span><span class="p">,</span>
               <span class="s1">&#39;YPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;10465&#39;</span><span class="p">,</span>
               <span class="s1">&#39;XPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;13495&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">},</span>
         <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;STATES&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Present&#39;</span><span class="p">,</span> <span class="s1">&#39;Absent&#39;</span><span class="p">],</span>
               <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span> <span class="s1">&#39;(b) Serum Calcium Increase&#39;</span><span class="p">,</span>
               <span class="s1">&#39;YPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;11965&#39;</span><span class="p">,</span>
               <span class="s1">&#39;XPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;11290&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">},</span>
         <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;STATES&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Present&#39;</span><span class="p">,</span> <span class="s1">&#39;Absent&#39;</span><span class="p">],</span>
               <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span> <span class="s1">&#39;(e) Papilledema&#39;</span><span class="p">,</span>
               <span class="s1">&#39;YPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;13240&#39;</span><span class="p">,</span>
               <span class="s1">&#39;XPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;17305&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">},</span>
         <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;STATES&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Present&#39;</span><span class="p">,</span> <span class="s1">&#39;Absent&#39;</span><span class="p">],</span>
               <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span> <span class="s1">&#39;(d) Coma&#39;</span><span class="p">,</span>
               <span class="s1">&#39;YPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;12985&#39;</span><span class="p">,</span>
               <span class="s1">&#39;XPOS&#39;</span><span class="p">:</span> <span class="s1">&#39;13960&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">}}</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)])</span>
<span class="n">cpd_distribution</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="s1">&#39;DPIS&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]])},</span>
                    <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="s1">&#39;DPIS&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]]),</span> <span class="s1">&#39;CONDSET&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;CARDINALITY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]},</span>
                    <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="s1">&#39;DPIS&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]]),</span> <span class="s1">&#39;CONDSET&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;CARDINALITY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]},</span>
                    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="s1">&#39;DPIS&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]]),</span> <span class="s1">&#39;CONDSET&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;CARDINALITY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]},</span>
                    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="s1">&#39;DPIS&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
                                                                <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]]),</span> <span class="s1">&#39;CONDSET&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;CARDINALITY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}}</span>

<span class="n">tabular_cpds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">cpd_distribution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="s1">&#39;CONDSET&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;CONDSET&#39;</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">cpd</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="s1">&#39;DPIS&#39;</span><span class="p">]</span>
    <span class="n">evidence_card</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="s1">&#39;CARDINALITY&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;CARDINALITY&#39;</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="s1">&#39;STATES&#39;</span><span class="p">]</span>
    <span class="n">cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">),</span> <span class="n">cpd</span><span class="p">,</span>
                     <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">,</span>
                     <span class="n">evidence_card</span><span class="o">=</span><span class="n">evidence_card</span><span class="p">)</span>
    <span class="n">tabular_cpds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpd</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="o">*</span><span class="n">tabular_cpds</span><span class="p">)</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[54]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.readwrite.XMLBeliefNetwork</span><span class="w"> </span><span class="kn">import</span> <span class="n">XBNWriter</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">XBNWriter</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</code></pre></div>
</div>
</div>







  
  






                
  <div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="stickybox"></div>
  <script>
    (function() {
      var nav = document.querySelector('.md-header__inner');
      if (!nav) return;

      var socialDiv = document.createElement('div');
      socialDiv.className = 'md-header__social';

      socialDiv.innerHTML =
        '<a href="https://github.com/pgmpy/pgmpy" target="_blank" rel="noopener" title="GitHub">' +
          '<svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.8-14.9-112.8-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://discord.gg/DRkdKaumBs" target="_blank" rel="noopener" title="Discord">' +
          '<svg viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91A483.689 483.689 0 0 0 116.085 69.137a1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375A487.666 487.666 0 0 0 176.02 479.918a1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665 0 53.306 26.82 52.843 59.239C275.334 310.993 251.924 337.58 222.491 337.58zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667 0 53.307 26.82 52.844 59.239C470.715 310.993 447.538 337.58 417.871 337.58z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://www.linkedin.com/company/pgmpy/" target="_blank" rel="noopener" title="LinkedIn">' +
          '<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/>' +
          '</svg>' +
        '</a>';

      nav.appendChild(socialDiv);
    })();
  </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, Ankur Ankan.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    9.1.0.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "1.0.0 (stable)", "version": "https://pgmpy.org"}, {"aliases": [], "title": "dev", "version": "https://pgmpy.org/dev"}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
  </body>
</html>



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="7.%20Parameterizing%20with%20Continuous%20Variables.html">
      
      
        <link rel="next" href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html">
      
      
      <link rel="icon" href="../_static/logo_favi.ico">
    
    
      
        <title>Sampling In Continuous Graphical Models - pgmpy</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.553f2186060d16162.min.css?v=c794c0f9" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0be4c15b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  <!-- SEO meta tags -->
  <meta name="description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="keywords" content="pgmpy, Bayesian Networks, causal inference, probabilistic graphical models, structure learning, parameter estimation, Python">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="pgmpy">
  <meta property="og:title" content="Sampling In Continuous Graphical Models">
  <meta property="og:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta property="og:url" content="https://pgmpy.org/detailed_notebooks/8.%20Sampling%20Algorithms.html">
  <meta property="og:image" content="https://pgmpy.org/_static/logo.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Sampling In Continuous Graphical Models">
  <meta name="twitter:description" content="pgmpy: A Python library for causal inference and probabilistic inference using Directed Acyclic Graphs (DAGs) and Bayesian Networks.">
  <meta name="twitter:image" content="https://pgmpy.org/_static/logo.png">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HCFR07M31W');
  </script>
  <!-- EthicalAds -->
  <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
  <!-- Header social links styling -->
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500;600&display=swap");
    :root {
      --md-text-font: "Source Sans 3", system-ui, sans-serif;
      --md-code-font: "Source Code Pro", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .md-header__social {
      display: flex;
      align-items: center;
      gap: 0.1rem;
      margin-left: 0.4rem;
    }
    .md-header__social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem;
      color: var(--md-default-fg-color--light);
      opacity: 0.7;
      transition: opacity 0.25s;
    }
    .md-header__social a:hover {
      opacity: 1;
    }
    .md-header__social svg {
      width: 1.2rem;
      height: 1.2rem;
      fill: currentColor;
    }
    [data-md-color-scheme="slate"] .md-header__social a {
      color: var(--md-default-fg-color--light);
    }
    /* Card visibility in light/dark modes */
    .sd-card {
      background-color: var(--pgmpy-card-bg, var(--md-default-bg-color));
      border: 1px solid var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
    }
    .sd-card .sd-card-header,
    .sd-card .sd-card-footer {
      border-color: var(--pgmpy-card-border, rgba(0, 0, 0, 0.08));
    }
    [data-md-color-scheme="slate"] .sd-card {
      --pgmpy-card-bg: rgba(255, 255, 255, 0.045);
      --pgmpy-card-border: rgba(255, 255, 255, 0.2);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
    }
    /* Hover shadow effect on feature cards */
    .sd-card-hover {
      transition: box-shadow 0.25s ease, transform 0.25s ease;
    }
    .sd-card-hover:hover {
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }
    [data-md-color-scheme="slate"] .sd-card-hover:hover {
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.55);
    }
    /* Center content when right sidebar (toc) is hidden */
    .md-sidebar--secondary[hidden] ~ .md-content {
      margin-left: auto;
      margin-right: auto;
    }
  </style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Hamiltonian-Monte-Carlo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="pgmpy" class="md-header__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pgmpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sampling In Continuous Graphical Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../started/base.html" class="md-tabs__link">
        
  
    
  
  <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../documentation.html" class="md-tabs__link">
        
  
    
  
  <span title="/documentation.rst (reference label)"><span>Documentation</span></span>

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../examples.html" class="md-tabs__link">
        
  
    
  
  <span title="/examples.rst (reference label)"><span>Examples</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api.html" class="md-tabs__link">
        
  
    
  
  <span title="/api.rst (reference label)"><span>API Reference</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../citation.html" class="md-tabs__link">
        
  
    
  
  <span title="/citation.rst (reference label)"><span>Citation</span></span>

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development.html" class="md-tabs__link">
        
  
    
  
  <span title="/development.rst (reference label)"><span>Getting Involved</span></span>

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="pgmpy" class="md-nav__button md-logo" aria-label="pgmpy" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    pgmpy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pgmpy/pgmpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pgmpy/pgmpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../started/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/started/base.rst (reference label)"><span>Getting Started</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/documentation.rst (reference label)"><span>Documentation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/examples.rst (reference label)"><span>Examples</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            <span title="/examples.rst (reference label)"><span>Examples</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples.html#tutorial-notebooks" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="tutorial notebooks (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_discrete_bn.ipynb (reference label)"><span>Creating Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Creating_Linear_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/creating_linear_bn.ipynb (reference label)"><span>Creating Linear Gaussian Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Defining_CPDs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/defining_cpds.ipynb (reference label)"><span>How to define Tabular<wbr>CPD and Linear<wbr>Gaussian<wbr>CPD</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Basic_Operations_on_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/basic_operations_on_bn.ipynb (reference label)"><span>Basic Operations on Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning.ipynb (reference label)"><span>Structure Learning in Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_Chow_Liu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_chow_liu.ipynb (reference label)"><span>Learning Tree Structure from Data using the Chow-<wbr>Liu Algorithm</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Structure_Learning_TAN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/structure_learning_tan.ipynb (reference label)"><span>Learning Tree-<wbr>augmented Naive Bayes <wbr>(TAN) Structure from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Expert_Knowledge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/expert_knowledge.ipynb (reference label)"><span>Expert Knowledge Integration with Causal Discovery</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_discrete_bn.ipynb (reference label)"><span>Parameter Learning in Discrete Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb (reference label)"><span>Marginal Learning in Discrete Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Parameter_Learning_Factor_Graphs.html#Modeling-the-home-&-visitor-scores" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/parameter_learning_factor_graphs.ipynb#modeling-the-home-&amp;-visitor-scores (reference label)"><span>Modeling the home &amp; visitor scores</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Inference_Discrete_BN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/inference_discrete_bn.ipynb (reference label)"><span>Inference in Discrete Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Monty_Hall.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/monty_hall.ipynb (reference label)"><span>Monty Hall Problem</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_inference.ipynb (reference label)"><span>Causal Inference Examples</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb (reference label)"><span>Causal Games</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-1" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-1 (reference label)"><span>Example 1</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-2" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-2 (reference label)"><span>Example 2</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-3" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-3 (reference label)"><span>Example 3</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-4" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-4 (reference label)"><span>Example 4</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-5" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-5 (reference label)"><span>Example 5</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-6" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-6 (reference label)"><span>Example 6</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Causal_Games.html#Example-7" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/causal_games.ipynb#example-7 (reference label)"><span>Example 7</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Simulating_Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/simulating_data.ipynb (reference label)"><span>Simulating Data From Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Extending_pgmpy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/extending_pgmpy.ipynb (reference label)"><span>Extending pgmpy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Functional_Bayesian_Network_Tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/functional_bayesian_network_tutorial.ipynb (reference label)"><span>Functional Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/Junction_Tree_Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/junction_tree_inference.ipynb (reference label)"><span>Junction Tree Exact Inference</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_27" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorial.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_27" id="__nav_3_1_27_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_27_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_27">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorial.rst (reference label)"><span>Tutorial Notebooks</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="1.%20Introduction%20to%20Probabilistic%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/1. introduction to probabilistic graphical models.ipynb (reference label)"><span>Introduction to Probabilitic Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="2.%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/2. bayesian networks.ipynb (reference label)"><span>Bayesian Network</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="3.%20Causal%20Bayesian%20Networks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/3. causal bayesian networks.ipynb (reference label)"><span>Causal Bayesian Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="4.%20Markov%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/4. markov models.ipynb (reference label)"><span>Markov Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="5.%20Exact%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/5. exact inference in graphical models.ipynb (reference label)"><span>Exact Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="6.%20Approximate%20Inference%20in%20Graphical%20Models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/6. approximate inference in graphical models.ipynb (reference label)"><span>Approximate Inference in Graphical Models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="7.%20Parameterizing%20with%20Continuous%20Variables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/7. parameterizing with continuous variables.ipynb (reference label)"><span>Parameterizing with Continuous Variables</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo (reference label)"><span>Hamiltonian Monte Carlo</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hamiltonian Monte Carlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Dynamics" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-dynamics (reference label)"><span>Hamiltonian Dynamics</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Discretizing-Hamiltonian's-Equations" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#discretizing-hamiltonian&#39;s-equations (reference label)"><span>Discretizing Hamiltonian’s Equations</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discretizing Hamiltonian’s Equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Euler's-Method" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#euler&#39;s-method (reference label)"><span>Euler’s Method</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Leapfrog-Method" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#leapfrog-method (reference label)"><span>Leapfrog Method</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Example:-Simulating-Hamiltonian-dynamics-of-a-simple-pendulum" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#example:-simulating-hamiltonian-dynamics-of-a-simple-pendulum (reference label)"><span>Example:<wbr> Simulating Hamiltonian dynamics of a simple pendulum</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-and-Probability:-Canonical-Distributions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-and-probability:-canonical-distributions (reference label)"><span>Hamiltonian and Probability:<wbr> Canonical Distributions</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-Algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-algorithm (reference label)"><span>Hamiltonian Monte Carlo Algorithm</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-in-pgmpy" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-in-pgmpy (reference label)"><span>Hamiltonian Monte Carlo in pgmpy</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-with-dual-averaging" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-with-dual-averaging (reference label)"><span>Hamiltonian Monte Carlo with dual averaging</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#No-U-Turn-Sampler" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#no-u-turn-sampler (reference label)"><span>No-<wbr>U-<wbr>Turn Sampler</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="No-U-Turn Sampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#No-U-Turn-Sampler-with-dual-averaging" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#no-u-turn-sampler-with-dual-averaging (reference label)"><span>No-<wbr>U-<wbr>Turn Sampler with dual averaging</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Support-for-coustom-Models" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#support-for-coustom-models (reference label)"><span>Support for coustom Models</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/9. reading and writing from pgmpy file formats.ipynb (reference label)"><span>Reading and Writing from pgmpy file formats</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="10.%20Learning%20Bayesian%20Networks%20from%20Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/10. learning bayesian networks from data.ipynb (reference label)"><span>Learning Bayesian Networks from Data</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/detailed_notebooks/11. a bayesian network to model the influence of energy consumption on greenhouse gases in italy.ipynb (reference label)"><span>A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api.rst (reference label)"><span>API Reference</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../citation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/citation.rst (reference label)"><span>Citation</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../development.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/development.rst (reference label)"><span>Getting Involved</span></span>
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb (reference label)"><span>Sampling In Continuous Graphical Models</span></span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo (reference label)"><span>Hamiltonian Monte Carlo</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hamiltonian Monte Carlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Dynamics" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-dynamics (reference label)"><span>Hamiltonian Dynamics</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Discretizing-Hamiltonian's-Equations" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#discretizing-hamiltonian&#39;s-equations (reference label)"><span>Discretizing Hamiltonian’s Equations</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discretizing Hamiltonian’s Equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Euler's-Method" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#euler&#39;s-method (reference label)"><span>Euler’s Method</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Leapfrog-Method" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#leapfrog-method (reference label)"><span>Leapfrog Method</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Example:-Simulating-Hamiltonian-dynamics-of-a-simple-pendulum" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#example:-simulating-hamiltonian-dynamics-of-a-simple-pendulum (reference label)"><span>Example:<wbr> Simulating Hamiltonian dynamics of a simple pendulum</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-and-Probability:-Canonical-Distributions" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-and-probability:-canonical-distributions (reference label)"><span>Hamiltonian and Probability:<wbr> Canonical Distributions</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-Algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-algorithm (reference label)"><span>Hamiltonian Monte Carlo Algorithm</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-in-pgmpy" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-in-pgmpy (reference label)"><span>Hamiltonian Monte Carlo in pgmpy</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Hamiltonian-Monte-Carlo-with-dual-averaging" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#hamiltonian-monte-carlo-with-dual-averaging (reference label)"><span>Hamiltonian Monte Carlo with dual averaging</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#No-U-Turn-Sampler" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#no-u-turn-sampler (reference label)"><span>No-<wbr>U-<wbr>Turn Sampler</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="No-U-Turn Sampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#No-U-Turn-Sampler-with-dual-averaging" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#no-u-turn-sampler-with-dual-averaging (reference label)"><span>No-<wbr>U-<wbr>Turn Sampler with dual averaging</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Support-for-coustom-Models" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/detailed_notebooks/8. sampling algorithms.ipynb#support-for-coustom-models (reference label)"><span>Support for coustom Models</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
  
                  


<h1 id="Sampling-In-Continuous-Graphical-Models">Sampling In Continuous Graphical Models<a class="headerlink" href="#Sampling-In-Continuous-Graphical-Models" title="Link to this heading">¶</a></h1>
<p>As we know inference is asking conditional probability questions to the models, the exact solution of these problems quickly becomes intractable. Sampling algorithms can be used to get approximate inference results by generating a large number of coherent samples that converge to original distribution. In this notebook we take a look at some of the sampling algorithms that can be used to sample from continuous case models.</p>
<ol class="arabic simple">
<li><p>Hamiltonian Monte Carlo</p></li>
<li><p>No-U-Turn Sample</p></li>
</ol>
<h2 id="Hamiltonian-Monte-Carlo">Hamiltonian Monte Carlo<a class="headerlink" href="#Hamiltonian-Monte-Carlo" title="Link to this heading">¶</a></h2>
<p>Hamiltonian Monte Carlo (HMC) is a Markov Chain Monte Carlo (MCMC) that proposes future states in Markov Chain using Hamiltonian Dynamics. Before understanding the HMC algorithm lets first understand Hamiltonian Dynamics.</p>
<h3 id="Hamiltonian-Dynamics">Hamiltonian Dynamics<a class="headerlink" href="#Hamiltonian-Dynamics" title="Link to this heading">¶</a></h3>
<p>Hamiltonian dynamics are used to describe how objects move throughout a system. Hamiltonian dynamics is defined in terms of object location <span class="math notranslate nohighlight">\(x\)</span> and its momentum <span class="math notranslate nohighlight">\(p\)</span> (equivalent to object’s mass times velocity) at some time <span class="math notranslate nohighlight">\(t\)</span>. For each location of object there is an associated potential energy <span class="math notranslate nohighlight">\(U(x)\)</span> and with momentum there is associated kinetic energy <span class="math notranslate nohighlight">\(K(p)\)</span>. The total energy of system is constant and is called as Hamiltonian <span class="math notranslate nohighlight">\(H(x, p)\)</span>, defined as the sum of
potential energy and kinetic energy:</p>
<div class="math notranslate nohighlight">
\[H(x, p) = U(x) + K(p)\]</div>
<p>The partial derivatives of the Hamiltonian determines how position <span class="math notranslate nohighlight">\(x\)</span> and momentum <span class="math notranslate nohighlight">\(p\)</span> change over time <span class="math notranslate nohighlight">\(t\)</span>, according to Hamiltonian’s equations:</p>
<div class="math notranslate nohighlight">
\[\frac{dx_i}{dt} = \frac{\partial H}{\partial p_i} = \frac{\partial K(p)}{\partial p_i}\]</div>
<div class="math notranslate nohighlight">
\[\frac{dp_i}{dt} = -\frac{\partial H}{\partial x_i} = -\frac{\partial U(x)}{\partial x_i}\]</div>
<p>The above equations operates on a <em>d-dimensional position vector</em> <span class="math notranslate nohighlight">\(x\)</span> and a <em>d-dimensional momentum vector</em> <span class="math notranslate nohighlight">\(p\)</span>, for <span class="math notranslate nohighlight">\(i = 1, 2, \cdots, d\)</span>.</p>
<p>Thus, if we can evaluate <span class="math notranslate nohighlight">\(\frac{\partial U(x)}{\partial x_i}\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial K(p)}{\partial p_i}\)</span> and have a set of initial conditions i.e an initial position and initial momentum at time <span class="math notranslate nohighlight">\(t_0\)</span>, then we can predict the location and momentum of object at any future time <span class="math notranslate nohighlight">\(t = t_0 + T\)</span> by simulating dynamics for a time duration <span class="math notranslate nohighlight">\(T\)</span>.</p>
<h3 id="Discretizing-Hamiltonian's-Equations">Discretizing Hamiltonian’s Equations<a class="headerlink" href="#Discretizing-Hamiltonian's-Equations" title="Link to this heading">¶</a></h3>
<p>The Hamiltonian’s equations describes an object’s motion in regard to time, which is a continuous variable. For simulating dynamics on a computer, Hamiltonian’s equations must be numerically approximated by discretizing time. This is done by splitting the time interval <span class="math notranslate nohighlight">\(T\)</span> into small intervals of size <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<h4 id="Euler's-Method">Euler’s Method<a class="headerlink" href="#Euler's-Method" title="Link to this heading">¶</a></h4>
<p>For Hamiltonian’s equations, this method performs the following steps, for each component of position and momentum (indexed by <span class="math notranslate nohighlight">\(i=1, ...,d\)</span>)</p>
<div class="math notranslate nohighlight">
\[p_i(t + \epsilon) = p_i(t) + \epsilon \frac{dp_i}{dt}(t) = p_i(t) - \epsilon \frac{\partial U}{\partial x_i(t)}\]</div>
<div class="math notranslate nohighlight">
\[x_i(t + \epsilon) = x_i(t) + \epsilon \frac{dx_i}{dt} = x_i(t) + \epsilon \frac{\partial K}{\partial p_i(t)}\]</div>
<p>Even better results can be obtained if we use updated value of momentum in later equation</p>
<div class="math notranslate nohighlight">
\[x_i(t + \epsilon) = x_i(t) + \epsilon \frac{\partial K}{\partial p_i(t + \epsilon)}\]</div>
<p>This method is called as <strong>Modified Euler’s method</strong>.</p>
<h4 id="Leapfrog-Method">Leapfrog Method<a class="headerlink" href="#Leapfrog-Method" title="Link to this heading">¶</a></h4>
<p>Unlike Euler’s method where we take full steps for updating position and momentum in leapfrog method we take half steps to update momentum value.</p>
<div class="math notranslate nohighlight">
\[p_i(t + \epsilon / 2) = p_i(t) - (\epsilon / 2) \frac{\partial U}{\partial x_i(t)}\]</div>
<div class="math notranslate nohighlight">
\[x_i(t + \epsilon) = x_i(t) + \epsilon \frac{\partial K}{\partial p_i(t + \epsilon /2)}\]</div>
<div class="math notranslate nohighlight">
\[p_i(t + \epsilon) = p_i(t) - (\epsilon / 2) \frac{\partial U}{\partial x_i(t + \epsilon)}\]</div>
<p>Leapfrog method yields even better result than Modified Euler Method.</p>
<h4 id="Example:-Simulating-Hamiltonian-dynamics-of-a-simple-pendulum">Example: Simulating Hamiltonian dynamics of a simple pendulum<a class="headerlink" href="#Example:-Simulating-Hamiltonian-dynamics-of-a-simple-pendulum" title="Link to this heading">¶</a></h4>
<p>Imagine a bob of mass <span class="math notranslate nohighlight">\(m = 1\)</span> attached to a string of length <span class="math notranslate nohighlight">\(l=1.5\)</span> whose one end is fixed at point <span class="math notranslate nohighlight">\((x=0, y=0)\)</span>. The equilibrium position of the pendulum is at <span class="math notranslate nohighlight">\(x = 0\)</span>. Now keeping string stretched we move it some distance horizontally say <span class="math notranslate nohighlight">\(x_0\)</span>. The corresponding change in potential energy is given by</p>
<p><span class="math notranslate nohighlight">\(U(h) = mg\Delta h\)</span>, where <span class="math notranslate nohighlight">\(\Delta h\)</span> is change in height and <span class="math notranslate nohighlight">\(g\)</span> is gravity of earth.</p>
<p>Using simple trigonometry one can derive relationship between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(\Delta h\)</span>.</p>
<div class="math notranslate nohighlight">
\[U(x) = mgl(1 - cos(sin^{-1}(x/l)))\]</div>
<p>Kinetic energy of bob can be written in terms of momentum as</p>
<div class="math notranslate nohighlight">
\[K(v) = \frac{mv^2}{2} = \frac{(mv)^2}{2m} = \frac{p^2}{2m} = K(p)\]</div>
<p>Further, partial derivatives of potential and kinetic energy can be written as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial U}{\partial x} = \frac{mglx}{\sqrt{l^2 - x^2}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\frac{\partial K}{\partial p} = \frac{p}{m}\]</div>
<p>Here is a animation that uses these equations to simulate the dynamics of simple pendulum <img alt="Drawing" src="../_images/simple_pendulum.gif" /></p>
<p>The sub-plot in the right upper half of the output demonstrates the energies. The red portion of first bar plot represents potential energy and black represents kinetic energy. The second bar plot represents the Hamiltonian. The lower right sub-plot shows the phase space showing how momentum and position are varying. We can see that phase space maps out an ellipse without deviating from its path. In case of Euler method the particle doesn’t fully trace a ellipse instead diverges slowly towards
infinity. One can clearly see that value of position and momentum are not completely random, but takes a deterministic circular kind of trajectory. If we use Leapfrog method to propose future states than we can avoid random-walk behavior which we saw in Metropolis-Hastings algorithm. This is the main reason for good performance of HMC algorithm.</p>
<h3 id="Hamiltonian-and-Probability:-Canonical-Distributions">Hamiltonian and Probability: Canonical Distributions<a class="headerlink" href="#Hamiltonian-and-Probability:-Canonical-Distributions" title="Link to this heading">¶</a></h3>
<p>Now having a bit of understanding what is Hamiltonian and how we can simulate Hamiltonian dynamics, we now need to understand how we can use these Hamiltonian dynamics for MCMC. We need to develop some relation between probability distribution and Hamiltonian so that we can use Hamiltonian dynamics to explore the distribution. To relate <span class="math notranslate nohighlight">\(H(x, p)\)</span> to target distribution <span class="math notranslate nohighlight">\(P(x)\)</span> we use a concept from statistical mechanics known as the canonical distribution. For any energy function
<span class="math notranslate nohighlight">\(E(q)\)</span>, defined over a set of variables <span class="math notranslate nohighlight">\(q\)</span>, we can find corresponding <span class="math notranslate nohighlight">\(P(q)\)</span></p>
<div class="math notranslate nohighlight">
\[P(q) = \frac{1}{Z} exp \left( \frac{-E(q)}{T} \right)\]</div>
<p>, where <span class="math notranslate nohighlight">\(Z\)</span> is normalizing constant called Partition function and <span class="math notranslate nohighlight">\(T\)</span> is temperature of system. For our use case we will consider <span class="math notranslate nohighlight">\(T=1\)</span>.</p>
<p>Since, the Hamiltonian is an energy function for the joint state of “position”, <span class="math notranslate nohighlight">\(x\)</span> and “momentum”, <span class="math notranslate nohighlight">\(p\)</span>, so we can define a joint distribution for them as follows:</p>
<div class="math notranslate nohighlight">
\[P(x, p) = \frac{e^{-H(x, p)}}{Z}\]</div>
<p>Since <span class="math notranslate nohighlight">\(H(x, p) = U(x) + K(p)\)</span>, we can write above equation as</p>
<div class="math notranslate nohighlight">
\[P(x, p) = \frac{e^{-U(x)-K(p)}}{z}\]</div>
<div class="math notranslate nohighlight">
\[P(x, p) = \frac{e^{-U(x)}e^{-K(p)}}{Z}\]</div>
<p>Furthermore we can associate probability distribution with each of the potential and kinetic energy (<span class="math notranslate nohighlight">\(P(x)\)</span> with potential energy and <span class="math notranslate nohighlight">\(P(p)\)</span>, with kinetic energy). Thus, we can write above equation as:</p>
<div class="math notranslate nohighlight">
\[P(x, p) = \frac{P(x)P(p)}{Z'}\]</div>
<p>,where <span class="math notranslate nohighlight">\(Z'\)</span> is new normalizing constant. Since joint distribution factorizes over <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span>, we can conclude that <span class="math notranslate nohighlight">\(P(x)\)</span> and <span class="math notranslate nohighlight">\(P(p)\)</span> are independent. Because of this independence we can choose any distribution from which we want to sample the momentum variable. A common choice is to use a zero mean and unit variance Normal distribution <span class="math notranslate nohighlight">\(N(0, I)\)</span> The target distribution of interest <span class="math notranslate nohighlight">\(P(x)\)</span> from which we actually want to sample from is associated with
potential energy.</p>
<div class="math notranslate nohighlight">
\[U(x) = - log (P(x))\]</div>
<p>Thus, if we can calculate <span class="math notranslate nohighlight">\(\frac{\partial log(P(x))}{\partial x_i}\)</span>, then we are in business and we can use Hamiltonian dynamics to generate samples.</p>
<h3 id="Hamiltonian-Monte-Carlo-Algorithm">Hamiltonian Monte Carlo Algorithm<a class="headerlink" href="#Hamiltonian-Monte-Carlo-Algorithm" title="Link to this heading">¶</a></h3>
<p>Given initial state <span class="math notranslate nohighlight">\(x_0\)</span>, stepsize <span class="math notranslate nohighlight">\(\epsilon\)</span>, number of steps <span class="math notranslate nohighlight">\(L\)</span>, log density function <span class="math notranslate nohighlight">\(U\)</span>, number of samples to be drawn <span class="math notranslate nohighlight">\(M\)</span>, we can write HMC algorithm as:</p>
<ul class="simple">
<li><p>set $m = 0 $</p></li>
<li><p>repeat until <span class="math notranslate nohighlight">\(m = M\)</span></p>
<ol class="arabic simple">
<li><p>set <span class="math notranslate nohighlight">\(m \leftarrow m + 1\)</span></p></li>
<li><p>Sample new initial momentum <span class="math notranslate nohighlight">\(p_0\)</span> ~ <span class="math notranslate nohighlight">\(N(0, I)\)</span></p></li>
<li><p>Set <span class="math notranslate nohighlight">\(x_m \leftarrow x_{m-1}, x' \leftarrow x_{m-1}, p' \leftarrow p_0\)</span></p></li>
<li><p>repeat for <span class="math notranslate nohighlight">\(L\)</span> steps</p>
<ul>
<li><p>Set <span class="math notranslate nohighlight">\(x', p' \leftarrow Leapfrog(x', p', \epsilon)\)</span></p></li>
</ul>
</li>
<li><p>Calculate acceptance probability <span class="math notranslate nohighlight">\(\alpha = min \left(1, \frac{exp( U(x') - (p'.p')/2 )}{exp( U(x_{m-1}) - (p_0.p_0)/2 )} \right)\)</span></p></li>
<li><p>Draw a random number u ~ Uniform(0, 1)</p></li>
<li><p>if <span class="math notranslate nohighlight">\(u \leq \alpha\)</span> then <span class="math notranslate nohighlight">\(x_m \leftarrow x', p_m \leftarrow -p'\)</span></p></li>
</ol>
</li>
</ul>
<p><span class="math notranslate nohighlight">\(Leapfrog\)</span> is a function that runs a single iteration of Leapfrog method.</p>
<p>In practice sometimes instead of explicitly giving number of steps <span class="math notranslate nohighlight">\(L\)</span>, we use <strong>trajectory length</strong> which is product of number of steps <span class="math notranslate nohighlight">\(L\)</span>, and stepsize <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<h3 id="Hamiltonian-Monte-Carlo-in-pgmpy">Hamiltonian Monte Carlo in pgmpy<a class="headerlink" href="#Hamiltonian-Monte-Carlo-in-pgmpy" title="Link to this heading">¶</a></h3>
<p>In pgmpy one can use Hamiltonian Monte Carlo algorithm by importing HamiltonianMC from pgmpy.inference.continuous</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">HamiltonianMC</span> <span class="k">as</span> <span class="n">HMC</span>
</code></pre></div>
</div>
</div>
<p>Lets use the HamiltonianMC implementation and draw some samples from a multivariate disrtibution <span class="math notranslate nohighlight">\(P(x) = N(\mu, \Sigma)\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mu = [0, 0], \qquad
\Sigma = \left[
    \begin{array}{cc}
    1 &amp; 0.97 \\
    0.97 &amp; 1
    \end{array}
    \right]\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.factors.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianDistribution</span> <span class="k">as</span> <span class="n">JGD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">LeapFrog</span><span class="p">,</span> <span class="n">GradLogPDFGaussian</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">77777</span><span class="p">)</span>
<span class="c1"># Defining a multivariate distribution model</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.97</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">JGD</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>

<span class="c1"># Creating a HMC sampling instance</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">HMC</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="o">=</span><span class="n">GradLogPDFGaussian</span><span class="p">,</span> <span class="n">simulate_dynamics</span><span class="o">=</span><span class="n">LeapFrog</span><span class="p">)</span>
<span class="c1"># Drawing samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                         <span class="n">trajectory_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span> <span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HMC samples&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;First 100 samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:18: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/__init__.py:917: UserWarning: axes.hold is deprecated. Please remove it from your matplotlibrc and/or style files.
  warnings.warn(self.msg_depr_set % key)
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/rcsetup.py:152: UserWarning: axes.hold is deprecated, will be removed in 3.0
  warnings.warn(&#34;axes.hold is deprecated, will be removed in 3.0&#34;)
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:21: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_3_1.png" src="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_3_1.png" />
</div>
</div>
<p>One, can change the values of parameters <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> and <code class="docutils literal notranslate"><span class="pre">trajectory_length</span></code> and see the convergence towards target distribution. For example set the value of <code class="docutils literal notranslate"><span class="pre">stepsize</span> <span class="pre">=</span> <span class="pre">0.5</span></code> and let rest parameters have the same value and see the output. With this you might get a feel that performance of HMC critically depends upon choice of these parameters.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> parameter for HamiltonianMC implementation is optional, but should be use only as starting point value. One should hand-tune the model using this stepsize value for good performance.</p>
<h3 id="Hamiltonian-Monte-Carlo-with-dual-averaging">Hamiltonian Monte Carlo with dual averaging<a class="headerlink" href="#Hamiltonian-Monte-Carlo-with-dual-averaging" title="Link to this heading">¶</a></h3>
<p>In pgmpy we have implemented an another variant of HMC in which we adapt the stepsize during the course of sampling thus completely eliminates the need of specifying <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> (but still requires <code class="docutils literal notranslate"><span class="pre">trajectory_length</span></code> to be specified by user). This variant of HMC is known as Hamiltonian Monte Carlo with dual averaging (HamiltonianMCda in pgmpy). One can also use Modified Euler to simulate dynamics instead of leapfrog, or even can plug-in one’s own implementation for simulating dynamics using
base class for it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">HamiltonianMCDA</span> <span class="k">as</span> <span class="n">HMCda</span><span class="p">,</span> <span class="n">ModifiedEuler</span>
<span class="c1"># Using modified euler instead of Leapfrog for simulating dynamics</span>
<span class="n">sampler_da</span> <span class="o">=</span> <span class="n">HMCda</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">GradLogPDFGaussian</span><span class="p">,</span> <span class="n">simulate_dynamics</span><span class="o">=</span><span class="n">ModifiedEuler</span><span class="p">)</span>
<span class="c1"># num_adapt is number of iteration to run adaptation of stepsize</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler_da</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">num_adapt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trajectory_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Acceptance rate:&quot;</span><span class="p">,</span><span class="n">sampler_da</span><span class="o">.</span><span class="n">acceptance_rate</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
               x         y
0   7.000000e+00  0.000000
1  3.458460e-323  0.000000
2  3.458460e-323  0.000000
3  3.458460e-323  0.000000
4  3.458460e-323  0.000000
5   3.614684e+00  0.780326
6   1.316832e+00  0.643645
7   1.316832e+00  0.643645
8  -1.111247e-01 -0.306480
9   1.163398e+00  1.357304

Acceptance rate: 0.5
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/pgmpy-0.1.6-py3.5.egg/pgmpy/sampling/HMC.py:111: RuntimeWarning: divide by zero encountered in double_scalars
  return (1/(acceptance_prob ** a)) &gt; (2**(-a))
</pre></div></div>
</div>
<p>The values returned by HamiltonianMC and HamiltonianMCda depends upon the installation available in the working environment. In working env has a installation of pandas, it returns a pandas.DataFrame object otherwise it returns a numpy.recarry (numpy recorded arrays).</p>
<p>Lets now use base class for simulating hamiltonian dynamics and write our own Modified Euler method</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseSimulateHamiltonianDynamics</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ModifiedEulerMethod</span><span class="p">(</span><span class="n">BaseSimulateHamiltonianDynamics</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">momentum</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="p">,</span> <span class="n">grad_log_position</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">BaseSimulateHamiltonianDynamics</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">momentum</span><span class="p">,</span>
                                                 <span class="n">stepsize</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="p">,</span> <span class="n">grad_log_position</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">new_position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_momentum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_grad_logp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_proposed_values</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_proposed_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_momentum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">momentum</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_position</span>
        <span class="n">new_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">*</span> <span class="n">new_momentum</span>

        <span class="n">grad_log</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_log_pdf</span><span class="p">(</span><span class="n">new_position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">get_gradient_log_pdf</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">new_position</span><span class="p">,</span> <span class="n">new_momentum</span><span class="p">,</span> <span class="n">grad_log</span>

<span class="n">hmc_sampler</span> <span class="o">=</span> <span class="n">HMC</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">GradLogPDFGaussian</span><span class="p">,</span> <span class="n">simulate_dynamics</span><span class="o">=</span><span class="n">ModifiedEulerMethod</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">hmc_sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trajectory_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total accepted proposal:&quot;</span><span class="p">,</span> <span class="n">hmc_sampler</span><span class="o">.</span><span class="n">accepted_proposals</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          x         y
0  0.000000  0.000000
1  0.624716  0.680638
2  0.928227  1.143031
3 -0.234847 -0.118653
4 -1.633648 -1.977647
5 -1.282438 -1.442565
6 -1.734446 -1.282935
7 -1.552439 -1.300669
8  0.729025  0.793016
9 -0.489195 -0.430182
Total accepted proposal: 10.0
</pre></div></div>
</div>
<h2 id="No-U-Turn-Sampler">No-U-Turn Sampler<a class="headerlink" href="#No-U-Turn-Sampler" title="Link to this heading">¶</a></h2>
<p>Both (HMC and HMCda) of these algorithms requires some hand-tuning from user, which can be time consuming especially for high dimensional complex model. No-U-Turn Sampler(NUTS) is an extension of HMC that eliminates the need to specify the trajectory length but requires user to specify stepsize.</p>
<p>NUTS, removes the need of parameter number of steps by considering a metric to evaluate whether we have ran Leapfrog algorithm for long enough, that is when running the simulation for more steps would no longer increase the distance between the proposal value of <span class="math notranslate nohighlight">\(x\)</span> and initial value of <span class="math notranslate nohighlight">\(x\)</span></p>
<p>At high level, NUTS uses the leapfrog method to trace out a path forward and backward in fictitious time, first running forwards or backwards 1 step, the forwards and backwards 2 steps, then forwards or backwards 4 steps etc. This doubling process builds a balanced binary tree whose leaf nodes correspond to position-momentum states. The doubling process is halted when the sub-trajectory from the leftmost to the rightmost nodes of any balanced subtree of the overall binary tree starts to double
back on itself (i.e., the fictional particle starts to make a “U-Turn”). At this point NUTS stops the simulation and samples from among the set of points computed during the simulation, taking are to preserve detailed balance.</p>
<p>Lets use NUTS and draw some samples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoUTurnSampler</span> <span class="k">as</span> <span class="n">NUTS</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">JGD</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">mean</span><span class="p">,</span> <span class="n">covariance</span><span class="p">)</span>

<span class="c1"># Creating sampling instance of NUTS</span>
<span class="n">NUTS_sampler</span> <span class="o">=</span> <span class="n">NUTS</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="o">=</span><span class="n">GradLogPDFGaussian</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">NUTS_sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NUTS Samples&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Warm-up period&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Scatter plot of samples&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/pgmpy-0.1.6-py3.5.egg/pgmpy/sampling/NUTS.py:130: RuntimeWarning: invalid value encountered in true_divide
  if np.random.rand() &lt; candidate_set_size2 / (candidate_set_size2 + candidate_set_size):
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:13: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/__init__.py:917: UserWarning: axes.hold is deprecated. Please remove it from your matplotlibrc and/or style files.
  warnings.warn(self.msg_depr_set % key)
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/rcsetup.py:152: UserWarning: axes.hold is deprecated, will be removed in 3.0
  warnings.warn(&#34;axes.hold is deprecated, will be removed in 3.0&#34;)
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:18: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_9_1.png" src="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_9_1.png" />
</div>
</div>
<p>The <strong>Warm-up period</strong> a.k.a <strong>Burn-in period</strong> of Markov chain , is the amount of time it takes for the markov chain to reach the target stationary distribution. The samples generated during this period of Markov chain are usually thrown away because they don’t show the characteristics of distribution from which they are sampled.</p>
<p>Since it is difficult to visualize more than 3-Dimensions we generally use a trace-plot of Markov chain to determine this warm-up period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Warm-up period&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Trace plot of Markov Chain&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:2: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
  from ipykernel import kernelapp as app
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/__init__.py:917: UserWarning: axes.hold is deprecated. Please remove it from your matplotlibrc and/or style files.
  warnings.warn(self.msg_depr_set % key)
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/rcsetup.py:152: UserWarning: axes.hold is deprecated, will be removed in 3.0
  warnings.warn(&#34;axes.hold is deprecated, will be removed in 3.0&#34;)
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:9: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_11_1.png" src="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_11_1.png" />
</div>
</div>
<h3 id="No-U-Turn-Sampler-with-dual-averaging">No-U-Turn Sampler with dual averaging<a class="headerlink" href="#No-U-Turn-Sampler-with-dual-averaging" title="Link to this heading">¶</a></h3>
<p>Like HMCda in No-U-Turn sampler with dual averaging (NUTSda) we adapt the stepsize during the course of sampling thus completely eliminates the need of specifying <code class="docutils literal notranslate"><span class="pre">stepsize</span></code>. Thus we can use NUTSda without any hand tuning at all.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoUTurnSamplerDA</span> <span class="k">as</span> <span class="n">NUTSda</span>
<span class="n">NUTSda_sampler</span> <span class="o">=</span> <span class="n">NUTSda</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="o">=</span><span class="n">GradLogPDFGaussian</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">NUTSda_sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="p">[</span><span class="mf">0.457420</span><span class="p">,</span> <span class="mf">0.500307</span><span class="p">,</span> <span class="mf">0.211056</span><span class="p">],</span> <span class="n">num_adapt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          x         y         z
0  0.457420  0.500307  0.211056
1  0.457420  0.500307  0.211056
2  0.457420  0.500307  0.211056
3  0.457420  0.500307  0.211056
4  1.822813  0.537422  0.005842
5 -0.195423  1.578560  1.047900
6  0.522322  0.176574  1.763822
7  0.124225  0.655759  4.003954
8  0.124225  0.655759  4.003954
9  0.337818  1.170382  4.146218
</pre></div></div>
</div>
<p>Apart from the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method all the four algorithms (HMC, HMCda, NUTS, NUTSda) provides another method to sample from model named <code class="docutils literal notranslate"><span class="pre">generate_sample</span></code> method. <code class="docutils literal notranslate"><span class="pre">generate_sample</span></code> method returns a generator type object whose each iteration yields a sample. The sample returned is a simple numpy.array object. The arguments for <code class="docutils literal notranslate"><span class="pre">generate_sample</span></code> method and <code class="docutils literal notranslate"><span class="pre">sample</span></code> method for all algorithms are same</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">generate_samples</span> <span class="o">=</span> <span class="n">NUTSda_sampler</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="p">[</span><span class="mf">0.4574</span><span class="p">,</span> <span class="mf">0.503</span><span class="p">,</span> <span class="mf">0.211</span><span class="p">],</span> <span class="n">num_adapt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sample</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">generate_samples</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[  1.23158312e+00   2.08966925e+00   5.47064070e+00]
 [  1.23158312e+00   2.08966925e+00   5.47064070e+00]
 [  1.23158312e+00   2.08966925e+00   5.47064070e+00]
 [  2.42754370e-04  -9.07581018e-01   2.22786641e+00]
 [  3.80037176e+00   4.20666799e+00   2.93898094e+00]
 [  1.84557224e+00   3.03691158e+00   5.05047756e+00]
 [  1.84557224e+00   3.03691158e+00   5.05047756e+00]
 [  1.90819711e+00   3.83294495e+00   4.98059422e+00]
 [  9.22139874e-01   4.11755511e+00   4.50041160e+00]
 [  9.22139874e-01   4.11755511e+00   4.50041160e+00]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/pgmpy-0.1.6-py3.5.egg/pgmpy/sampling/NUTS.py:412: RuntimeWarning: invalid value encountered in true_divide
  if np.random.rand() &lt; candidate_set_size2 / (candidate_set_size2 + candidate_set_size):
</pre></div></div>
</div>
<h2 id="Support-for-coustom-Models">Support for coustom Models<a class="headerlink" href="#Support-for-coustom-Models" title="Link to this heading">¶</a></h2>
<p>One can also use HMC, HMCda, NUTS and NUTSda to sample from a user defined model, all one has to do is create class for finding log of probability density function and gradient log of probability density function using base class provided by pgmpy, and give this class as a parameter to <code class="docutils literal notranslate"><span class="pre">grad_log_pdf</span></code> argument in all of these algorithms (HMC[da], NUTS[da]).</p>
<p>In this example we will define our own logisitcs distribution and use NUTSda to sample from it.</p>
<p>The probability density of logistic distribution is given by:</p>
<div class="math notranslate nohighlight">
\[P(x; \mu, s) = \frac{e^{-\frac{x- \mu}{s}}}{s(1 + e^{-\frac{x - \mu}{s}})^2}\]</div>
<p>Thus the log of this probability density function (potential energy function) can be written as:</p>
<div class="math notranslate nohighlight">
\[log(P(x; \mu, s)) = -\frac{x - \mu}{s} - log(s) - 2 log(1 + e^{-\frac{x - \mu}{s}})\]</div>
<p>And the gradient of potential energy :</p>
<div class="math notranslate nohighlight">
\[\frac{\partial log(P(x; \mu, s))}{\partial x} = - \frac{1}{s} + \frac{2e^{-\frac{x - \mu}{s}}}{s(1 + e^{-\frac{x - \mu}{s}})}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Importing th base class structure for log and gradient log of probability density function</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseGradLogPDF</span>

<span class="c1"># Base class for user defined continuous factor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pgmpy.factors.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomDistribution</span>


<span class="c1"># Defining pdf of a Logistic distribution with mu = 5, s = 2</span>
<span class="k">def</span><span class="w"> </span><span class="nf">logistic_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">power</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Calculating log of logistic pdf</span>
<span class="k">def</span><span class="w"> </span><span class="nf">log_logistic</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">power</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">power</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span><span class="p">))</span>

<span class="c1"># Calculating gradient log of logistic pdf</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad_log_logistic</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">power</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">return</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Creating a logistic model</span>
<span class="n">logistic_model</span> <span class="o">=</span> <span class="n">CustomDistribution</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">logistic_pdf</span><span class="p">)</span>

<span class="c1"># Creating a class using base class for gradient log and log probability density function</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GradLogLogistic</span><span class="p">(</span><span class="n">BaseGradLogPDF</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable_assignments</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="n">BaseGradLogPDF</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable_assignments</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_log</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gradient_log_pdf</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_gradient_log_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">grad_log_logistic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable_assignments</span><span class="p">),</span>
                <span class="n">log_logistic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable_assignments</span><span class="p">))</span>

<span class="c1"># Generating samples using NUTS</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">NUTSda</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">logistic_model</span><span class="p">,</span> <span class="n">grad_log_pdf</span><span class="o">=</span><span class="n">GradLogLogistic</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">initial_pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span> <span class="n">num_adapt</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                         <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">logistic_pdf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;real logistic pdf&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples NUTSda&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/utgup/anaconda3/lib/python3.5/site-packages/pgmpy-0.1.6-py3.5.egg/pgmpy/sampling/NUTS.py:412: RuntimeWarning: invalid value encountered in true_divide
  if np.random.rand() &lt; candidate_set_size2 / (candidate_set_size2 + candidate_set_size):
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:45: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/__init__.py:917: UserWarning: axes.hold is deprecated. Please remove it from your matplotlibrc and/or style files.
  warnings.warn(self.msg_depr_set % key)
/home/utgup/anaconda3/lib/python3.5/site-packages/matplotlib/rcsetup.py:152: UserWarning: axes.hold is deprecated, will be removed in 3.0
  warnings.warn(&#34;axes.hold is deprecated, will be removed in 3.0&#34;)
/home/utgup/anaconda3/lib/python3.5/site-packages/ipykernel/__main__.py:49: MatplotlibDeprecationWarning: pyplot.hold is deprecated.
    Future behavior will be consistent with the long-time default:
    plot commands add elements without first clearing the
    Axes and/or Figure.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_17_1.png" src="../../../pgmpy_docs/doctrees/nbsphinx/detailed_notebooks_8._Sampling_Algorithms_17_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>







  
  






                
  <div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="stickybox"></div>
  <script>
    (function() {
      var nav = document.querySelector('.md-header__inner');
      if (!nav) return;

      var socialDiv = document.createElement('div');
      socialDiv.className = 'md-header__social';

      socialDiv.innerHTML =
        '<a href="https://github.com/pgmpy/pgmpy" target="_blank" rel="noopener" title="GitHub">' +
          '<svg viewBox="0 0 496 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.8-14.9-112.8-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://discord.gg/DRkdKaumBs" target="_blank" rel="noopener" title="Discord">' +
          '<svg viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91A483.689 483.689 0 0 0 116.085 69.137a1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375A487.666 487.666 0 0 0 176.02 479.918a1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665 0 53.306 26.82 52.843 59.239C275.334 310.993 251.924 337.58 222.491 337.58zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667 0 53.307 26.82 52.844 59.239C470.715 310.993 447.538 337.58 417.871 337.58z"/>' +
          '</svg>' +
        '</a>' +
        '<a href="https://www.linkedin.com/company/pgmpy/" target="_blank" rel="noopener" title="LinkedIn">' +
          '<svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">' +
            '<path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/>' +
          '</svg>' +
        '</a>';

      nav.appendChild(socialDiv);
    })();
  </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, Ankur Ankan.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    9.1.0.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "search.share", "toc.follow", "content.tabs.link"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "1.0.0 (stable)", "version": "https://pgmpy.org"}, {"aliases": [], "title": "dev", "version": "https://pgmpy.org/dev"}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script src="../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>